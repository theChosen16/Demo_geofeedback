<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GeoFeedback Chile - Inteligencia Territorial</title>
    <meta
      name="description"
      content="Plataforma open source de analisis geoespacial para Chile."
    />
    <link rel="canonical" href="https://geofeedback.cl/" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700;800&family=Inter:wght@300;400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      :root {
          /* Elegant Natural Color Palette */
          --primary: #2D5A4A;
          --primary-light: #3D7A5F;
          --secondary: #A68B5B;
          --secondary-light: #C4A46D;
          --accent: #E8B86D;
          --danger: #C45B5B;
          --text: #2C3E2D;
          --text-light: #5A6B5C;
          --background: #FAFAF8;
          --white: #ffffff;
          --border: #D4CFC4;
          --shadow: 0 4px 6px -1px rgba(45, 90, 74, 0.1);
          --shadow-lg: 0 10px 15px -3px rgba(45, 90, 74, 0.15);
          /* Modern Typography */
          --font-accent: 'Outfit', sans-serif;
          --font-body: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      }
      * { margin: 0; padding: 0; box-sizing: border-box; }
      html { scroll-behavior: smooth; }
      body {
          font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
          background: var(--background);
          color: var(--text);
          line-height: 1.6;
      }
      .navbar {
          position: fixed;
          top: 0; left: 0; right: 0;
          background: rgba(255,255,255,0.95);
          backdrop-filter: blur(10px);
          z-index: 1000;
          padding: 1rem 2rem;
          box-shadow: var(--shadow);
      }
      .navbar-content {
          max-width: 1400px;
          margin: 0 auto;
          display: flex;
          justify-content: space-between;
          align-items: center;
      }
      .logo {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          font-size: 1.5rem;
          font-weight: 700;
          color: var(--primary);
          text-decoration: none;
          font-family: var(--font-accent);
      }
      .logo i { color: var(--secondary); }
      .nav-links { display: flex; gap: 2rem; align-items: center; }
      .nav-links a { color: var(--text); text-decoration: none; font-weight: 500; }
      .nav-links a:hover { color: var(--secondary); }
      .btn {
          padding: 0.75rem 1.5rem;
          border-radius: 8px;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.3s;
          border: none;
          display: inline-flex;
          align-items: center;
          gap: 0.5rem;
          text-decoration: none;
          font-size: 0.95rem;
      }
      .btn-primary {
          background: linear-gradient(135deg, var(--secondary), var(--secondary-light));
          color: white;
      }
      .btn-primary:hover {
          transform: translateY(-2px);
          box-shadow: 0 4px 12px rgba(166, 139, 91, 0.4);
      }
      .btn-secondary { background: var(--primary); color: white; }
      .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none !important; }
      .hero {
          min-height: 100vh;
          display: flex;
          align-items: center;
          padding: 8rem 2rem 4rem;
          background: linear-gradient(135deg, var(--primary) 0%, #1a3d30 100%);
      }
      .hero-content {
          max-width: 1400px;
          margin: 0 auto;
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 4rem;
          align-items: center;
      }
      .hero-text h1 {
          font-size: 3.5rem;
          font-weight: 800;
          color: white;
          line-height: 1.3;
          margin-bottom: 1.5rem;
      }
      .hero-text h1 span {
          font-family: var(--font-accent);
          font-size: 3.8rem;
          font-weight: 700;
          font-style: italic;
          background: linear-gradient(135deg, var(--secondary), var(--accent));
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
          display: block;
          line-height: 1.4;
      }
      .hero-text p { font-size: 1.25rem; color: rgba(255,255,255,0.9); margin-bottom: 2rem; }
      .hero-buttons { display: flex; gap: 1rem; flex-wrap: wrap; }
      .hero-visual {
          display: flex;
          justify-content: center;
          align-items: center;
          position: relative;
          width: 100%;
          height: 400px;
      }
      /* Earth-Satellite Animation Container */
      .earth-satellite-animation {
          position: relative;
          width: 320px;
          height: 320px;
      }
      /* Stars Background */
      .stars-container {
          position: absolute;
          width: 100%;
          height: 100%;
          overflow: hidden;
          border-radius: 50%;
      }
      .star {
          position: absolute;
          background: white;
          border-radius: 50%;
          animation: twinkle 2s ease-in-out infinite;
      }
      .star:nth-child(1) { width: 2px; height: 2px; top: 10%; left: 20%; animation-delay: 0s; }
      .star:nth-child(2) { width: 3px; height: 3px; top: 25%; left: 85%; animation-delay: 0.3s; }
      .star:nth-child(3) { width: 2px; height: 2px; top: 45%; left: 10%; animation-delay: 0.6s; }
      .star:nth-child(4) { width: 2px; height: 2px; top: 70%; left: 75%; animation-delay: 0.9s; }
      .star:nth-child(5) { width: 3px; height: 3px; top: 85%; left: 30%; animation-delay: 1.2s; }
      .star:nth-child(6) { width: 2px; height: 2px; top: 15%; left: 60%; animation-delay: 0.4s; }
      .star:nth-child(7) { width: 2px; height: 2px; top: 55%; left: 90%; animation-delay: 0.8s; }
      .star:nth-child(8) { width: 3px; height: 3px; top: 90%; left: 55%; animation-delay: 1.5s; }
      @keyframes twinkle {
          0%, 100% { opacity: 0.3; transform: scale(1); }
          50% { opacity: 1; transform: scale(1.2); }
      }
      /* PROFESSIONAL 3D EARTH */
      .earth {
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 220px;
          height: 220px;
          border-radius: 50%;
          z-index: 10;
          /* Multi-layer background for depth */
          background: 
            /* Clouds */
            url('data:image/svg+xml;utf8,<svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg"><filter id="noise"><feTurbulence type="fractalNoise" baseFrequency="0.65" numOctaves="3" stitchTiles="stitch"/></filter><rect width="100%" height="100%" opacity="0.4" filter="url(%23noise)"/></svg>'),
            /* Atmosphere Glow */
            radial-gradient(circle at 30% 30%, rgba(255,255,255,0.1) 0%, transparent 20%),
            /* Oceans (Night/Day terminator) */
            linear-gradient(115deg, #0b3d91 0%, #102e52 50%, #051528 100%);
          
          /* Realistic Lighting Model */
          box-shadow: 
              inset -20px -20px 50px rgba(0,0,0,0.9),    /* Deep space shadow */
              inset 10px 10px 30px rgba(70, 160, 255, 0.4), /* Upper atmosphere light */
              0 0 25px rgba(66, 133, 244, 0.4),          /* Outer glow */
              0 0 60px rgba(66, 133, 244, 0.1);          /* Distant halo */
          
          overflow: hidden;
      }
      
      /* Continents Layer (Stylized realistic shapes) */
      .earth::before {
          content: '';
          position: absolute;
          top: 0; left: 0;
          width: 200%; height: 100%;
          background-image: url('data:image/svg+xml;utf8,<svg viewBox="0 0 400 200" xmlns="http://www.w3.org/2000/svg"><path d="M50,40 Q70,20 90,40 T130,60 T160,100 T120,150 T80,180 T40,140 T20,90 T50,40 M240,50 Q260,30 280,50 T320,80 T350,120 T300,160 T250,140 T220,100 T240,50" fill="%234caf50" opacity="0.6" /></svg>');
          background-size: cover;
          opacity: 0.7;
          filter: blur(0.5px) contrast(1.2);
          animation: earthRotation 60s linear infinite;
          mix-blend-mode: overlay;
      }

      /* Moving Clouds Layer */
      .earth::after {
          content: '';
          position: absolute;
          top: 0; left: 0;
          width: 200%; height: 100%;
          background: url('data:image/svg+xml;utf8,<svg viewBox="0 0 400 200" xmlns="http://www.w3.org/2000/svg"><filter id="cloudNoise"><feTurbulence type="fractalNoise" baseFrequency="0.012" numOctaves="5" seed="5"/></filter><rect width="100%" height="100%" filter="url(%23cloudNoise)" opacity="0.4" fill="white"/></svg>');
          background-size: 50% 100%; /* Tile it */
          opacity: 0.45;
          mix-blend-mode: soft-light;
          animation: cloudsMove 90s linear infinite;
      }

      @keyframes earthRotation {
          from { background-position: 0 0; }
          to { background-position: -200% 0; }
      }
      @keyframes cloudsMove {
          from { background-position: 0 0; }
          to { background-position: -150% 0; }
      }

      /* PROFESSIONAL 3D SATELLITE STRUCTURE */
      .satellite-container {
          position: absolute;
          top: 50%; left: 50%;
          width: 550px; height: 550px; /* Increased Orbit diameter (Halo) */
          transform-style: preserve-3d;
          transform: translate(-50%, -50%) rotateX(15deg); /* Halo Orbit: Less tilt to circle perimeter */
          animation: orbitRotate 20s linear infinite;
      }

      .satellite-body-group {
          position: absolute;
          top: 0; left: 50%;
          width: 40px; height: 40px;
          transform-style: preserve-3d;
          transform: translateX(-50%) rotateX(-90deg) rotateY(45deg); /* Tilted cube */
          animation: counterRotate 20s linear infinite;
      }

      /* 3D CUBE BODY */
      .sat-cube {
          position: absolute;
          width: 30px; height: 30px;
          transform-style: preserve-3d;
      }
      .cube-face {
          position: absolute;
          width: 30px; height: 30px;
          border: 1px solid rgba(184, 134, 11, 0.5);
          background: linear-gradient(135deg, #DAA520, #FFD700); /* Gold foil */
          box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
      }
      .face-front  { transform: translateZ(15px); }
      .face-back   { transform: rotateY(180deg) translateZ(15px); }
      .face-right  { transform: rotateY(90deg) translateZ(15px); }
      .face-left   { transform: rotateY(-90deg) translateZ(15px); }
      .face-top    { transform: rotateX(90deg) translateZ(15px); background: #c0c0c0; /* Silver top */ }
      .face-bottom { transform: rotateX(-90deg) translateZ(15px); }

      /* THICK SOLAR PANELS */
      .solar-panel-group {
          position: absolute;
          top: 5px;
          width: 60px; height: 25px;
          transform-style: preserve-3d;
      }
      .panel-left-group { left: -60px; transform: rotateY(-10deg); }
      .panel-right-group { left: 30px; transform: rotateY(10deg); }

      .panel-face {
          position: absolute;
          width: 100%; height: 100%;
          background: 
              linear-gradient(90deg, transparent 49%, #000 50%, transparent 51%),
              linear-gradient(rgba(255,255,255,0.1), rgba(0,0,0,0.1)),
              linear-gradient(135deg, #051937, #004d7a);
          background-size: 10px 100%, 100% 100%, 100% 100%;
          border: 1px solid #888;
      }
      .panel-front { transform: translateZ(1px); }
      .panel-back  { transform: translateZ(-1px) rotateY(180deg); background: #333; } /* Grey back */

      /* Orbit Animation - Constant Z-Index for Halo */
      @keyframes orbitRotate {
          0% { transform: translate(-50%, -50%) rotateX(15deg) rotateZ(0deg); z-index: 20; }
          100% { transform: translate(-50%, -50%) rotateX(15deg) rotateZ(360deg); z-index: 20; }
      }
      
      /* Counter rotation to keep satellite upright */
      @keyframes counterRotate {
          0% { transform: translateX(-50%) rotateX(-90deg) rotateY(45deg) rotateZ(0deg); }
          100% { transform: translateX(-50%) rotateX(-90deg) rotateY(45deg) rotateZ(-360deg); }
      }


      /* Z-Index Animation keyframes - Adjusted for visual horizon */
      /* Z-Index Animation keyframes - Precision switch for 200px Earth */
      @keyframes orbitZIndex {
          0% { z-index: 20; }   /* In front */
          25% { z-index: 20; }  /* In front side */
          48% { z-index: 0; }   /* Pass behind */
          75% { z-index: 0; }   /* Behind side */
          98% { z-index: 20; }  /* Return to front */
          100% { z-index: 20; }
      }
      @keyframes orbitSatellite {
          0% { transform: translate(-50%, -50%) rotateX(70deg) rotateZ(0deg); }
          100% { transform: translate(-50%, -50%) rotateX(70deg) rotateZ(360deg); }
      }

      /* Data Points */
      .data-points {
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 180px;
          height: 180px;
      }
      .data-point {
          position: absolute;
          width: 6px;
          height: 6px;
          background: var(--accent);
          border-radius: 50%;
          animation: pulse 2s ease-in-out infinite;
      }
      .data-point:nth-child(1) { top: 30%; left: 40%; animation-delay: 0s; }
      .data-point:nth-child(2) { top: 50%; left: 65%; animation-delay: 0.5s; }
      .data-point:nth-child(3) { top: 70%; left: 35%; animation-delay: 1s; }
      .data-point:nth-child(4) { top: 40%; left: 55%; animation-delay: 1.5s; }
      @keyframes pulse {
          0%, 100% { opacity: 0.3; transform: scale(1); box-shadow: 0 0 5px var(--accent); }
          50% { opacity: 1; transform: scale(1.5); box-shadow: 0 0 15px var(--accent); }
      }
      .section { padding: 6rem 2rem; }
      .section-dark { background: var(--primary); color: white; }
      .section-light { background: var(--white); }
      .container { max-width: 1200px; margin: 0 auto; }
      .section-header { text-align: center; margin-bottom: 4rem; }
      .section-header h2 { font-size: 2.5rem; font-weight: 700; margin-bottom: 1rem; }
      .section-header p { font-size: 1.1rem; color: var(--text-light); max-width: 600px; margin: 0 auto; }
      .section-dark .section-header p { color: rgba(255,255,255,0.7); }
      .cards-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
          gap: 2rem;
      }
      .card {
          background: rgba(255,255,255,0.05);
          border: 1px solid rgba(255,255,255,0.1);
          border-radius: 16px;
          padding: 2rem;
          transition: transform 0.3s;
      }
      .card:hover { transform: translateY(-5px); }
      .card i { font-size: 2.5rem; color: var(--accent); margin-bottom: 1rem; }
      .card h3 { font-size: 1.25rem; margin-bottom: 0.75rem; }
      .card p { color: rgba(255,255,255,0.7); font-size: 0.95rem; }
      .card-light { background: var(--background); border: 1px solid var(--border); }
      .card-light:hover { box-shadow: var(--shadow-lg); }
      .card-light i { color: var(--secondary); }
      .card-light h3 { color: var(--primary); }
      .card-light p { color: var(--text-light); }
      .demo-section {
          background: linear-gradient(180deg, var(--background) 0%, #e2e8f0 100%);
          padding: 6rem 2rem;
      }
      .demo-container { max-width: 1400px; margin: 0 auto; }
      .demo-layout {
          display: grid;
          grid-template-columns: 1fr 420px;
          gap: 1.5rem;
          margin-top: 2rem;
      }
      .map-container {
          background: white;
          border-radius: 16px;
          overflow: hidden;
          box-shadow: var(--shadow-lg);
          position: relative;
      }
      #demo-map { width: 100%; height: 550px; background: #e5e7eb; }
      .map-controls {
          position: absolute;
          top: 1rem; right: 1rem;
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
          z-index: 10;
      }
      .map-control-btn {
          background: white;
          border: none;
          width: 40px; height: 40px;
          border-radius: 8px;
          cursor: pointer;
          box-shadow: var(--shadow);
          display: flex;
          align-items: center;
          justify-content: center;
      }
      .map-control-btn:hover { background: var(--secondary); color: white; }
      .map-placeholder {
          position: absolute;
          top: 50%; left: 50%;
          transform: translate(-50%, -50%);
          text-align: center;
          color: var(--text-light);
      }
      .map-placeholder i { font-size: 3rem; margin-bottom: 1rem; opacity: 0.5; }
      .sidebar { display: flex; flex-direction: column; gap: 1rem; }
      .panel {
          background: white;
          border-radius: 12px;
          padding: 1.25rem;
          box-shadow: var(--shadow);
      }
      .panel-header {
          font-size: 0.9rem;
          color: var(--text-light);
          margin-bottom: 0.75rem;
          display: flex;
          align-items: center;
          gap: 0.5rem;
          font-weight: 500;
      }
      .search-wrapper { position: relative; }
      .search-wrapper i {
          position: absolute;
          left: 1rem; top: 50%;
          transform: translateY(-50%);
          color: var(--text-light);
      }
      .search-input {
          width: 100%;
          padding: 0.875rem 1rem 0.875rem 2.75rem;
          border: 2px solid var(--border);
          border-radius: 8px;
          font-size: 0.95rem;
      }
      .search-input:focus { outline: none; border-color: var(--secondary); }
      .location-badge {
          display: none;
          background: linear-gradient(135deg, var(--secondary), var(--secondary-light));
          color: white;
          border-radius: 8px;
          padding: 0.75rem 1rem;
          margin-top: 0.75rem;
      }
      .location-badge.active { display: block; }
      .location-badge h4 { font-size: 1rem; margin-bottom: 0.25rem; }
      .location-badge p { font-size: 0.8rem; opacity: 0.9; margin: 0; }
      .approach-select {
          width: 100%;
          padding: 0.875rem;
          border: 2px solid var(--border);
          border-radius: 8px;
          font-size: 0.95rem;
          cursor: pointer;
          background: white;
      }
      .approach-select:focus { outline: none; border-color: var(--secondary); }
      .indices-panel {
          display: none;
          margin-top: 1rem;
          padding-top: 1rem;
          border-top: 1px solid var(--border);
      }
      .indices-panel.active { display: block; }
      .indices-title {
          font-size: 0.85rem;
          font-weight: 600;
          color: var(--primary);
          margin-bottom: 0.75rem;
      }
      .index-item {
          background: var(--background);
          border-radius: 8px;
          padding: 0.75rem;
          margin-bottom: 0.5rem;
      }
      .index-header {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          margin-bottom: 0.25rem;
      }
      .index-color { width: 12px; height: 12px; border-radius: 3px; }
      .index-name { font-weight: 600; font-size: 0.85rem; color: var(--primary); }
      .index-desc { font-size: 0.8rem; color: var(--text-light); line-height: 1.4; }
      .index-api {
          font-size: 0.7rem;
          background: var(--primary);
          color: white;
          padding: 0.15rem 0.4rem;
          border-radius: 4px;
          margin-left: auto;
      }
      #analyze-btn { width: 100%; padding: 1rem; font-size: 1rem; margin-top: 0.5rem; }
      .status-bar { display: flex; gap: 1rem; margin-bottom: 1rem; }
      .status-item {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          font-size: 0.8rem;
          color: var(--text-light);
      }
      .status-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--border); }
      .status-dot.ready { background: var(--secondary); }
      .results-grid {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 1rem;
          margin-top: 1.5rem;
      }
      .result-card {
          background: white;
          border-radius: 12px;
          padding: 1.25rem;
          display: flex;
          align-items: flex-start;
          gap: 1rem;
          box-shadow: var(--shadow);
      }
      .result-icon { font-size: 2rem; color: var(--secondary); }
      .result-content h4 { font-size: 1rem; color: var(--primary); margin-bottom: 0.25rem; }
      .result-content p { font-size: 0.85rem; color: var(--text-light); margin: 0; }
      .live-data {
          display: none;
          margin-top: 1rem;
          padding: 1rem;
          background: linear-gradient(135deg, #1e3a5f 0%, #0f2744 100%);
          border-radius: 8px;
          color: white;
      }
      .live-data.active { display: block; }
      .live-data h4 {
          font-size: 0.85rem;
          margin-bottom: 0.75rem;
          display: flex;
          align-items: center;
          gap: 0.5rem;
      }
      .live-data-grid {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 0.5rem;
      }
      .live-data-item {
          background: rgba(255,255,255,0.1);
          padding: 0.5rem;
          border-radius: 6px;
      }
      .live-data-label { font-size: 0.7rem; opacity: 0.7; }
      .live-data-value { font-size: 0.9rem; font-weight: 600; }
      footer {
          background: var(--primary);
          color: white;
          padding: 3rem 2rem;
      }
      .footer-content {
          max-width: 1200px;
          margin: 0 auto;
          display: flex;
          justify-content: space-between;
          align-items: center;
          flex-wrap: wrap;
          gap: 2rem;
      }
      .footer-logo { display: flex; align-items: center; gap: 0.75rem; font-size: 1.25rem; font-weight: 700; }
      .footer-logo i { color: var(--secondary); }
      .footer-links { display: flex; gap: 2rem; }
      .footer-links a { color: rgba(255,255,255,0.7); text-decoration: none; }
      .footer-links a:hover { color: var(--secondary); }
      .social-links { display: flex; gap: 1rem; }
      .social-links a {
          width: 40px; height: 40px;
          background: rgba(255,255,255,0.1);
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          color: white;
      }
      .social-links a:hover { background: var(--secondary); }

      /* Team Section */
      .team-section {
          padding: 4rem 2rem;
          background: linear-gradient(135deg, #f8fafc 0%, #e0f2fe 100%);
      }
      .team-container {
          max-width: 1200px;
          margin: 0 auto;
      }
      .section-title {
          text-align: center;
          font-size: 2rem;
          color: var(--primary);
          margin-bottom: 0.5rem;
      }
      .section-subtitle {
          text-align: center;
          color: var(--text-light);
          margin-bottom: 3rem;
      }
      .team-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
          gap: 2rem;
          justify-items: center;
      }
      .team-card {
          background: white;
          border-radius: 16px;
          padding: 2rem;
          text-align: center;
          box-shadow: var(--shadow-lg);
          transition: transform 0.3s;
          max-width: 320px;
      }
      .team-card:hover { transform: translateY(-5px); }
      .team-avatar {
          width: 100px;
          height: 100px;
          border-radius: 50%;
          background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
          display: flex;
          align-items: center;
          justify-content: center;
          margin: 0 auto 1rem;
          font-size: 2.5rem;
          color: white;
      }
      .team-name { font-size: 1.25rem; font-weight: 600; color: var(--primary); margin-bottom: 0.25rem; }
      .team-role { color: var(--secondary); font-weight: 500; margin-bottom: 1rem; }
      .team-linkedin {
          display: inline-flex;
          align-items: center;
          gap: 0.5rem;
          background: #0077B5;
          color: white;
          padding: 0.5rem 1rem;
          border-radius: 8px;
          text-decoration: none;
          font-size: 0.9rem;
          transition: background 0.3s;
      }
      .team-linkedin:hover { background: #005885; }

      /* Contact Section */
      .contact-section {
          padding: 4rem 2rem;
          background: var(--primary);
      }
      .contact-container {
          max-width: 600px;
          margin: 0 auto;
      }
      .contact-section .section-title { color: white; }
      .contact-section .section-subtitle { color: rgba(255,255,255,0.7); }
      .contact-form {
          background: rgba(255,255,255,0.1);
          backdrop-filter: blur(10px);
          border-radius: 16px;
          padding: 2rem;
      }
      .form-group { margin-bottom: 1.5rem; }
      .form-group label {
          display: block;
          color: white;
          font-weight: 500;
          margin-bottom: 0.5rem;
      }
      .form-group input, .form-group textarea {
          width: 100%;
          padding: 0.75rem 1rem;
          border: 1px solid rgba(255,255,255,0.2);
          border-radius: 8px;
          background: rgba(255,255,255,0.1);
          color: white;
          font-size: 1rem;
          box-sizing: border-box;
      }
      .form-group input::placeholder, .form-group textarea::placeholder {
          color: rgba(255,255,255,0.5);
      }
      .form-group input:focus, .form-group textarea:focus {
          outline: none;
          border-color: var(--secondary);
      }
      .form-group textarea { min-height: 120px; resize: vertical; }
      .btn-submit {
          width: 100%;
          padding: 1rem;
          background: var(--secondary);
          color: white;
          border: none;
          border-radius: 8px;
          font-size: 1rem;
          font-weight: 600;
          cursor: pointer;
          transition: background 0.3s;
      }
      .btn-submit:hover { background: var(--secondary-light); }
      .btn-submit:disabled { opacity: 0.6; cursor: not-allowed; }
      .form-success {
          background: rgba(16, 185, 129, 0.2);
          border: 1px solid var(--secondary);
          padding: 1rem;
          border-radius: 8px;
          color: white;
          text-align: center;
          margin-top: 1rem;
          display: none;
      }

      @media (max-width: 1024px) {
          .demo-layout {
              grid-template-columns: 1fr;
              gap: 1.5rem;
          }
          .sidebar { order: 2; }
          .map-container { order: 1; }
          #demo-map { height: 50vh; min-height: 400px; }
          .results-grid { grid-template-columns: 1fr; }
      }
      @media (max-width: 768px) {
          /* Global mobile width fixes */
          html, body {
              overflow-x: hidden !important;
              width: 100% !important;
              max-width: 100vw !important;
          }
          * {
              box-sizing: border-box !important;
          }
          .container, .demo-container, .team-container, .contact-container {
              width: 100% !important;
              max-width: 100% !important;
              padding-left: 1rem !important;
              padding-right: 1rem !important;
          }
          .section {
              padding: 2rem 1rem !important;
          }
            .demo-section {
                padding-top: 5rem !important;
                padding-bottom: 2rem !important;
                padding-left: 0 !important;
                padding-right: 0 !important;
            }
            .intro_text {
                padding: 0 1rem;
            }
            .demo-container {
                width: 100% !important;
                max-width: 100% !important;
                padding-left: 0 !important;
                padding-right: 0 !important;
            }
          .cards-grid {
              grid-template-columns: 1fr !important;
              gap: 1rem !important;
              padding: 0 !important;
          }
          .card {
              width: 100% !important;
              max-width: 100% !important;
              transform: none !important;
          }
          .team-grid {
              grid-template-columns: 1fr !important;
              gap: 1rem !important;
          }
          .team-card {
              max-width: 100% !important;
              width: 100% !important;
          }
            .demo-layout {
                grid-template-columns: 1fr !important;
                gap: 0 !important;
            }
            .map-container {
                border-radius: 0 !important;
                border: none !important;
            }
            #demo-map {
                height: 55vh !important;
                min-height: 400px !important;
                border-radius: 0 !important;
            }
          .map-control-btn {
              width: 44px !important;
              height: 44px !important;
              font-size: 1.2rem !important;
          }
          .sidebar {
              width: 100% !important;
          }
            .panel {
                width: 100% !important;
                padding: 1.5rem 1rem !important;
                border-radius: 0 !important;
                border-left: none !important;
                border-right: none !important;
                border-top: none !important;
                border-bottom: 1px solid #eee !important;
                margin-bottom: 0 !important;
                box-shadow: none !important;
            }
          .results-grid {
              grid-template-columns: 1fr !important;
              gap: 0.75rem !important;
          }
          .hero {
              padding: 4rem 1rem 2rem !important;
              min-height: auto !important;
          }
          .hero-content {
              grid-template-columns: 1fr !important;
              text-align: center;
              gap: 2rem !important;
          }
          .hero-text h1 {
              font-size: 1.75rem !important;
              line-height: 1.2 !important;
          }
          .hero-text p {
              font-size: 1rem !important;
          }
          .hero-buttons {
              justify-content: center;
              flex-wrap: wrap;
          }
          /* Mobile Earth-Satellite Animation */
          .hero-visual {
              height: 200px !important;
              margin-bottom: 1rem;
          }
          .earth-satellite-animation {
              width: 180px !important;
              height: 180px !important;
          }
          .earth {
              width: 100px !important;
              height: 100px !important;
          }
          .orbit-path,
          .satellite-wrapper {
              width: 190px !important;
              height: 190px !important;
          }
          .satellite-3d {
              transform: translateX(-50%) rotateX(-90deg) scale(0.7) !important;
          }
          .data-points {
              width: 100px !important;
              height: 100px !important;
          }

          .stars-container .star {
              display: none;
          }
          .stars-container .star:nth-child(-n+4) {
              display: block;
          }
          .nav-links { display: none; }
          .section-header h2 {
              font-size: 1.5rem !important;
          }
          .section-header p {
              font-size: 0.9rem !important;
          }
          /* Contact form mobile */
          .contact-form {
              padding: 1.5rem !important;
          }
          .form-group input, .form-group textarea {
              font-size: 16px !important; /* Prevents zoom on iOS */
          }
          /* Footer mobile */
          .footer-content {
              flex-direction: column !important;
              text-align: center !important;
              gap: 1.5rem !important;
          }
          .footer-links {
              flex-direction: column !important;
              gap: 0.75rem !important;
          }
          /* Fix chat button position to avoid overlap with mobile-tabs */
          .chat-toggle-btn {
              bottom: 5.5rem !important;
              right: 1.25rem !important;
              width: 56px !important;
              height: 56px !important;
              box-shadow: 0 4px 15px rgba(0,0,0,0.3) !important;
              z-index: 999 !important;
          }
          .chat-sidebar {
              width: 100% !important;
              height: 100% !important;
              right: -100% !important;
              bottom: 0 !important;
              border-radius: 0 !important;
              z-index: 2001 !important;
          }
          .chat-sidebar.open {
              right: 0 !important;
          }
          .chat-messages {
              height: calc(100% - 130px) !important;
              padding: 1rem !important;
          }
          .message-bubble {
              max-width: 90% !important;
              font-size: 0.95rem !important;
          }
          .chat-input-wrapper {
              padding: 0.75rem !important;
              background: white !important;
              border-top: 1px solid #eee !important;
          }

          /* Mobile Tab Navigation */
          .mobile-tabs {
              display: flex !important;
              position: fixed;
              bottom: 0;
              left: 0;
              right: 0;
              background: linear-gradient(135deg, var(--primary), var(--primary-light));
              z-index: 2000;
              box-shadow: 0 -4px 20px rgba(0,0,0,0.15);
              padding: 0.5rem 0;
              padding-bottom: env(safe-area-inset-bottom, 0.5rem);
          }
          .mobile-tab {
              flex: 1;
              display: flex;
              flex-direction: column;
              align-items: center;
              padding: 0.5rem;
              color: rgba(255,255,255,0.7);
              text-decoration: none;
              font-size: 0.7rem;
              transition: all 0.3s ease;
              border: none;
              background: transparent;
              cursor: pointer;
          }
          .mobile-tab i { font-size: 1.25rem; margin-bottom: 0.25rem; }
          .mobile-tab.active, .mobile-tab:hover {
              color: var(--accent);
              transform: translateY(-2px);
          }
          .mobile-tab.active i { transform: scale(1.1); }

          /* Tab Content Sections */
          .tab-section {
              display: none;
              animation: fadeSlideIn 0.4s ease;
          }
          .tab-section.active { display: block; }

          /* Hide desktop sections on mobile when tabs are active */
          body.mobile-tab-mode .desktop-section { display: none !important; }
          body.mobile-tab-mode .tab-section.active { display: block !important; }
          body.mobile-tab-mode { padding-bottom: 70px; }
          body.mobile-tab-mode .navbar { display: none; }

          /* Mobile header - NOT fixed, scrolls with content */
          .mobile-header {
              display: none !important; /* Hide mobile header, use navbar instead */
          }
          /* Keep regular navbar visible on mobile */
          .navbar {
              position: relative !important;
              padding: 0.75rem 1rem !important;
          }
          .navbar .logo {
              font-size: 1.1rem !important;
          }
          body.mobile-tab-mode .navbar {
              display: flex !important;
          }
          body.mobile-tab-mode { padding-bottom: 70px; }

          /* Responsive tables */
          table {
              display: block !important;
              width: 100% !important;
              overflow-x: auto !important;
              -webkit-overflow-scrolling: touch !important;
          }
          .table-responsive {
              display: block;
              width: 100%;
              overflow-x: auto;
              -webkit-overflow-scrolling: touch;
          }

          /* Dashboard stats grid */
          [style*="grid-template-columns:repeat(4"] {
              grid-template-columns: repeat(2, 1fr) !important;
              gap: 0.75rem !important;
          }

          /* Fluid elements */
          img, video, iframe, embed, object {
              max-width: 100% !important;
              height: auto !important;
          }

          /* Prevent any element from exceeding viewport */
          div, section, article, aside, header, footer, main, nav {
              max-width: 100vw !important;
          }

          /* Alert/notification cards */
          [style*="display:flex"][style*="align-items:center"][style*="gap:1rem"] {
              flex-wrap: wrap !important;
              gap: 0.5rem !important;
          }

          /* Pricing cards equal height */
          .cards-grid .card {
              margin-bottom: 1rem !important;
          }

          /* California Script Typography */
          .script-title {
              font-family: var(--font-script) !important;
              font-size: 2.5rem !important;
              font-weight: 600;
          }
          .hero-text h1 span {
              font-family: var(--font-script);
              font-size: 3rem;
          }

          /* Card animations */
          .card, .team-card, .result-card {
              animation: slideUp 0.5s ease forwards;
              opacity: 0;
          }
          .card:nth-child(1) { animation-delay: 0.1s; }
          .card:nth-child(2) { animation-delay: 0.2s; }
          .card:nth-child(3) { animation-delay: 0.3s; }
          .card:nth-child(4) { animation-delay: 0.4s; }
      }

      /* Animations */
      @keyframes fadeSlideIn {
          from { opacity: 0; transform: translateY(20px); }
          to { opacity: 1; transform: translateY(0); }
      }
      @keyframes slideUp {
          from { opacity: 0; transform: translateY(30px); }
          to { opacity: 1; transform: translateY(0); }
      }
      @keyframes slideFromRight {
          from { transform: translateX(100%); opacity: 0; }
          to { transform: translateX(0); opacity: 1; }
      }

      /* California Script for desktop too */
      .script-title {
          font-family: var(--font-script);
      }

      /* Hide mobile elements on desktop */
      .mobile-tabs, .mobile-header { display: none; }
      .pac-container {
          border-radius: 8px;
          border: 1px solid var(--border);
          box-shadow: var(--shadow-lg);
          margin-top: 4px;
          font-family: 'Inter', sans-serif;
      }
      .pac-item { padding: 10px 14px; cursor: pointer; }
      .pac-item:hover { background: var(--background); }
      .pac-icon { display: none; }
      .loading-spinner {
          display: inline-block;
          width: 16px;
          height: 16px;
          border: 2px solid rgba(255,255,255,0.3);
          border-top-color: white;
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
      }
      @keyframes spin { to { transform: rotate(360deg); } }

      /* Modal Styles */
      .modal-overlay {
          display: none;
          position: fixed;
          top: 0; left: 0; right: 0; bottom: 0;
          background: rgba(0,0,0,0.7);
          z-index: 2000;
          justify-content: center;
          align-items: center;
          padding: 2rem;
      }
      .modal-overlay.active { display: flex; }
      .modal-content {
          background: white;
          border-radius: 16px;
          max-width: 700px;
          width: 100%;
          max-height: 90vh;
          overflow-y: auto;
          box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      }
      .modal-header {
          background: linear-gradient(135deg, var(--primary), var(--primary-light));
          color: white;
          padding: 1.5rem;
          border-radius: 16px 16px 0 0;
          display: flex;
          justify-content: space-between;
          align-items: center;
      }
      .modal-header h3 { margin: 0; font-size: 1.3rem; }
      .modal-close {
          background: none;
          border: none;
          color: white;
          font-size: 1.5rem;
          cursor: pointer;
          opacity: 0.8;
      }
      .modal-close:hover { opacity: 1; }
      .modal-body { padding: 1.5rem; }
      .scale-section {
          background: var(--background);
          border-radius: 12px;
          padding: 1rem;
          margin-bottom: 1rem;
      }
      .scale-title {
          font-weight: 600;
          color: var(--primary);
          margin-bottom: 0.5rem;
          display: flex;
          align-items: center;
          gap: 0.5rem;
      }
      .scale-bar {
          height: 20px;
          border-radius: 10px;
          margin: 0.5rem 0;
      }
      .scale-bar.ndvi { background: linear-gradient(to right, #8B0000, #FF6B6B, #FFFF00, #90EE90, #006400); }
      .scale-bar.ndwi { background: linear-gradient(to right, #8B4513, #FFD700, #90EE90, #87CEEB, #000080); }
      .scale-bar.slope { background: linear-gradient(to right, #22c55e, #ffd700, #ff6b6b); }
      .scale-labels {
          display: flex;
          justify-content: space-between;
          font-size: 0.75rem;
          color: var(--text-light);
      }
      .interpretation-text {
          background: white;
          border-left: 4px solid var(--secondary);
          padding: 0.75rem 1rem;
          margin-top: 0.75rem;
          border-radius: 0 8px 8px 0;
          font-size: 0.9rem;
          line-height: 1.5;
      }
      .value-badge {
          display: inline-block;
          background: var(--secondary);
          color: white;
          padding: 0.25rem 0.75rem;
          border-radius: 20px;
          font-weight: 600;
          font-size: 0.85rem;
          margin-left: 0.5rem;
      }

      /* Chat Sidebar Styles */
      .chat-toggle-btn {
          position: fixed;
          bottom: 2rem;
          right: 2rem;
          width: 60px;
          height: 60px;
          border-radius: 50%;
          background: linear-gradient(135deg, var(--primary), var(--secondary));
          color: white;
          border: none;
          font-size: 1.5rem;
          cursor: pointer;
          box-shadow: 0 4px 20px rgba(0,0,0,0.3);
          z-index: 1500;
          transition: transform 0.3s ease;
      }
      .chat-toggle-btn:hover { transform: scale(1.1); }

      .chat-sidebar {
          position: fixed;
          right: -420px;
          top: 0;
          width: 400px;
          height: 100vh;
          background: white;
          box-shadow: -5px 0 30px rgba(0,0,0,0.2);
          z-index: 2000;
          transition: right 0.3s ease;
          display: flex;
          flex-direction: column;
      }
      .chat-sidebar.open { right: 0; }

      .chat-header {
          background: linear-gradient(135deg, var(--primary), var(--primary-light));
          color: white;
          padding: 1rem 1.5rem;
          display: flex;
          justify-content: space-between;
          align-items: center;
      }
      .chat-header h4 { margin: 0; font-size: 1.1rem; }
      .chat-close {
          background: none;
          border: none;
          color: white;
          font-size: 1.5rem;
          cursor: pointer;
      }

      .chat-messages {
          flex: 1;
          overflow-y: auto;
          padding: 1rem;
          background: #f8fafc;
      }

      .chat-message {
          margin-bottom: 1rem;
          max-width: 85%;
          animation: fadeIn 0.3s ease;
      }
      @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

      .chat-message.user {
          margin-left: auto;
          text-align: right;
      }
      .chat-message.user .message-bubble {
          background: var(--primary);
          color: white;
          border-radius: 16px 16px 4px 16px;
      }
      .chat-message.assistant .message-bubble {
          background: white;
          border: 1px solid #e2e8f0;
          border-radius: 16px 16px 16px 4px;
      }
      .message-bubble {
          padding: 0.75rem 1rem;
          display: inline-block;
      }
      .message-time {
          font-size: 0.7rem;
          color: var(--text-light);
          margin-top: 0.25rem;
      }

      .chat-input-wrapper {
          padding: 1rem;
          border-top: 1px solid #e2e8f0;
          background: white;
          display: flex;
          gap: 0.5rem;
      }
      .chat-input {
          flex: 1;
          padding: 0.75rem 1rem;
          border: 1px solid #e2e8f0;
          border-radius: 24px;
          font-size: 0.9rem;
          outline: none;
      }
      .chat-input:focus { border-color: var(--secondary); }
      .chat-send {
          width: 44px;
          height: 44px;
          border-radius: 50%;
          background: var(--secondary);
          color: white;
          border: none;
          cursor: pointer;
      }
      .chat-send:disabled { background: #ccc; }

      .ai-interpretation {
          background: linear-gradient(135deg, #f0fdf4, #ecfeff);
          border-left: 4px solid var(--secondary);
          padding: 1rem;
          margin-top: 1rem;
          border-radius: 0 8px 8px 0;
          white-space: pre-wrap;
          line-height: 1.6;
      }
      .ai-interpretation h5 {
          margin: 0 0 0.5rem 0;
          color: var(--primary);
      }
      .ai-loading {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          color: var(--text-light);
      }
      .typing-indicator span {
          width: 8px;
          height: 8px;
          border-radius: 50%;
          background: var(--secondary);
          display: inline-block;
          animation: typing 1s infinite;
      }
      .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
      .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }
      @keyframes typing { 0%, 100% { opacity: 0.3; } 50% { opacity: 1; } }
    </style>
  </head>
  <body>
    <!-- Mobile Header (visible only on mobile) -->
    <div class="mobile-header">
      <div class="logo">
        <i class="fas fa-globe-americas"></i
        ><span class="script-title">GeoFeedback</span>
      </div>
    </div>

    <!-- Mobile Tab Navigation (visible only on mobile) -->
    <nav class="mobile-tabs">
      <button
        class="mobile-tab active"
        onclick="switchTab('inicio')"
        data-tab="inicio"
      >
        <i class="fas fa-home"></i>
        <span>Inicio</span>
      </button>
      <button class="mobile-tab" onclick="switchTab('demo')" data-tab="demo">
        <i class="fas fa-map-marked-alt"></i>
        <span>Demo</span>
      </button>
      <button
        class="mobile-tab"
        onclick="switchTab('servicios')"
        data-tab="servicios"
      >
        <i class="fas fa-rocket"></i>
        <span>Servicios</span>
      </button>
      <button
        class="mobile-tab"
        onclick="switchTab('contacto')"
        data-tab="contacto"
      >
        <i class="fas fa-envelope"></i>
        <span>Contacto</span>
      </button>
    </nav>
    <nav class="navbar">
      <div class="navbar-content">
        <a href="#" class="logo"
          ><i class="fas fa-globe-americas"></i>GeoFeedback</a
        >
        <div class="nav-links">
          <a href="#problema" data-en="Problem">Problema</a>
          <a href="#solucion" data-en="Solution">Solucion</a>
          <a href="#demo" data-en="Demo">Demo</a>
          <a href="#servicios" data-en="Services">Servicios</a>
          <a href="/api/docs" class="btn btn-primary"
            ><i class="fas fa-code"></i> API</a
          >
          <button
            class="btn btn-secondary"
            id="lang-toggle"
            onclick="toggleLanguage()"
            style="padding: 0.5rem 0.75rem; min-width: auto;"
            title="Switch Language"
          >
            <span id="lang-icon">ðŸ‡ºðŸ‡¸</span> <span id="lang-text" style="font-size: 0.8rem">EN</span>
          </button>
        </div>
      </div>
    </nav>

    <section id="demo" class="demo-section" style="padding-top: 8rem">
      <div class="demo-container">
        <div class="section-header intro_text">
          <h2 data-en="Interactive Demo">Demo Interactivo</h2>
          <p data-en="Select location and approach to explore processed satellite data">
            Selecciona ubicacion y enfoque para explorar datos satelitales procesados
          </p>
        </div>

        <!-- Nota Informativa: Datos Tiempo Real -->
        <div style="background: #fff3cd; color: #856404; padding: 1rem; border-radius: 8px; margin-bottom: 2rem; border: 1px solid #ffeeba; display: flex; gap: 1rem; align-items: flex-start; max-width: 900px; margin-left: auto; margin-right: auto;">
            <i class="fas fa-info-circle" style="margin-top: 0.25rem; font-size: 1.2rem;"></i>
            <div style="text-align: left;">
                <strong style="display: block; margin-bottom: 0.25rem;" data-en="Note on data frequency:">Nota sobre la frecuencia de datos:</strong>
                <p style="margin: 0; font-size: 0.9rem; line-height: 1.5;" data-en-html="This demo uses the Google Earth Engine Research/Non-Commercial license. Images (Sentinel-2) have a 5-day frequency at the equator, but thanks to orbital overlap, at latitudes like Chile, this is reduced to <strong>2 to 3 days</strong>.<br/><i class='fas fa-check-circle' style='color: #2D5A4A; margin-right: 4px;'></i> <strong>'Real Time' (Live) monitoring is available exclusively in the Commercial Enterprise version.</strong>">
                    Esta demostracion utiliza la licencia de investigacion/no comercial de Google Earth Engine. Las imagenes (Sentinel-2) tienen un tiempo de frecuencia de 5 dias en el ecuador, pero gracias al solapamiento de orbitas, en latitudes como Chile, esto se reduce a <strong>2 a 3 dias</strong>.
                    <br/>
                    <i class="fas fa-check-circle" style="color: #2D5A4A; margin-right: 4px;"></i> <strong>El monitoreo en 'Tiempo Real' (Live) esta disponible exclusivamente en la version Comercial Enterprise.</strong>
                </p>
                 <p style="margin-top: 0.5rem; font-size: 0.85rem; opacity: 0.9; border-top: 1px solid rgba(133, 100, 4, 0.2); padding-top: 0.5rem;">
                    <strong>Metodologia:</strong> Los indices se calculan procesando bandas espectrales de luz no visible. El area de analisis se determina geometricamente (Area = &pi; &times; r&sup2;) cubriendo la superficie exacta del radio seleccionado.
                </p>
            </div>
        </div>
        <div class="demo-layout">
          <div class="map-container">
            <div id="demo-map">
              <div class="map-placeholder" id="map-placeholder">
                <i class="fas fa-map-marked-alt"></i>
                <p>Cargando mapa...</p>
              </div>
            </div>
            <div class="map-controls">
              <button
                class="map-control-btn"
                onclick="centerMap()"
                title="Centrar en Chile"
              >
                <i class="fas fa-home"></i>
              </button>
              <button
                class="map-control-btn"
                onclick="toggleMapType()"
                title="Cambiar vista"
              >
                <i class="fas fa-layer-group"></i>
              </button>
            </div>
          </div>
          <div class="sidebar">
            <div class="panel">
              <div class="status-bar">
                <div class="status-item" data-en-html='<span class="status-dot" id="status-location"></span>Location'>
                  <span class="status-dot" id="status-location"></span>Ubicacion
                </div>
                <div class="status-item" data-en-html='<span class="status-dot" id="status-approach"></span>Approach'>
                  <span class="status-dot" id="status-approach"></span>Enfoque
                </div>
              </div>
            </div>
            <div class="panel">
              <div class="panel-header" data-en-html='<i class="fas fa-search"></i> Search Location'>
                <i class="fas fa-search"></i> Buscar Ubicacion
              </div>
              <div class="search-wrapper">
                <div id="autocomplete-container"></div>
              </div>
              <div class="location-badge" id="location-badge">
                <h4 id="location-name">-</h4>
                <p id="location-coords">-</p>
              </div>
              <div class="live-data" id="live-data">
                <h4>
                  <i class="fas fa-broadcast-tower"></i> Monitor en Vivo (Ejemplo)
                </h4>
                <div class="live-data-grid">
                  <div class="live-data-item">
                    <div class="live-data-label" data-en="Elevation">Elevacion</div>
                    <div class="live-data-value" id="data-elevation">--</div>
                  </div>
                  <div class="live-data-item">
                    <div class="live-data-label" data-en="Air Quality (AQI)">Calidad Aire (AQI)</div>
                    <div class="live-data-value" id="data-aqi">--</div>
                  </div>
                  <div class="live-data-item">
                    <div class="live-data-label" data-en="Solar Potential">Potencial Solar</div>
                    <div class="live-data-value" id="data-solar">--</div>
                  </div>
                  <div class="live-data-item">
                    <div class="live-data-label" data-en="Slope">Pendiente</div>
                    <div class="live-data-value" id="data-slope">--</div>
                  </div>
                </div>
              </div>
            </div>
            <div class="panel">
              <div class="panel-header" data-en-html='<i class="fas fa-crosshairs"></i> Select Approach'>
                <i class="fas fa-crosshairs"></i> Seleccionar Enfoque
              </div>
              <select
                id="approach-select"
                class="approach-select"
                onchange="onApproachChange()"
              >
                <option value="" data-en="-- Choose an analysis approach --">-- Elige un enfoque de analisis --</option>
                <optgroup label="Sectores Industriales" data-en-label="Industrial Sectors">
                  <option value="mining" data-en="Sustainable Mining">Mineria Sostenible</option>
                  <option value="agriculture" data-en="Smart Agribusiness">Agroindustria Inteligente</option>
                  <option value="energy" data-en="Renewable Energy">Energias Renovables</option>
                  <option value="real-estate" data-en="Real Estate Development">Desarrollo Inmobiliario</option>
                </optgroup>
                <optgroup label="Analisis General" data-en-label="General Analysis">
                  <option value="fire-risk" data-en="Forest Fire Risk">Riesgo de Incendio Forestal</option>
                  <option value="flood-risk" data-en="Flood Risk">Riesgo de Inundacion</option>
                  <option value="water-management" data-en="Water Management">Gestion Hidrica</option>
                  <option value="environmental" data-en="Environmental Quality">Calidad Ambiental</option>
                  <option value="land-planning" data-en="Territorial Planning">
                    Planificacion Territorial
                  </option>
                </optgroup>
              </select>
              <div class="indices-panel" id="indices-panel">
                <div class="indices-title" data-en="Analysis indices and data:">Indices y datos del analisis:</div>
                <div id="analysis-results" style="display: none"></div>
                <div id="indices-list"></div>
              </div>
            </div>
            <div class="panel">
              <div class="panel-header" data-en-html='<i class="fas fa-ruler-combined"></i> Analysis Radius'>
                <i class="fas fa-ruler-combined"></i> Radio de Analisis
              </div>
              <select
                id="radius-select"
                class="approach-select"
                onchange="onRadiusChange()"
              >
                <option value="">-- Selecciona el radio --</option>
                <option value="2000" selected>2 kilometros (~12.57 kmÂ²)</option>
                <option value="5000">5 kilometros (~78.54 kmÂ²)</option>
                <option value="10000">10 kilometros (~314.16 kmÂ²)</option>
              </select>
              <div
                style="
                  font-size: 0.75rem;
                  color: var(--text-light);
                  margin-top: 0.5rem;
                "
              >
                <i class="fas fa-info-circle"></i> El radio define el area
                circular alrededor del punto para el analisis.
              </div>
            </div>
            <div class="panel">
              <button
                class="btn btn-primary"
                id="analyze-btn"
                onclick="analyzeTerritory()"
                disabled
                data-en-html='<i class="fas fa-satellite-dish"></i> Start Analysis'
              >
                <i class="fas fa-satellite-dish"></i> Iniciar Analisis
              </button>
              <p
                style="
                  font-size: 0.8rem;
                  color: var(--text-light);
                  margin-top: 0.5rem;
                  text-align: center;
                "
              >
                Requiere ubicacion y enfoque seleccionados
              </p>
            </div>
          </div>
        </div>
        <div class="results-grid">
          <div class="result-card" id="result-location">
            <i class="fas fa-map-marker-alt result-icon"></i>
            <div class="result-content">
              <h4 data-en="Location">Ubicacion</h4>
              <p data-en="Search or click on the map">Busca o haz clic en el mapa</p>
            </div>
          </div>
          <div class="result-card" id="result-approach">
            <i class="fas fa-crosshairs result-icon"></i>
            <div class="result-content">
              <h4 data-en="Approach">Enfoque</h4>
              <p data-en="Select analysis type">Selecciona el tipo de analisis</p>
            </div>
          </div>
          <div class="result-card">
            <i class="fas fa-satellite result-icon"></i>
            <div class="result-content">
              <h4 data-en="Integrated APIs">APIs Integradas</h4>
              <p>Elevation, Air Quality, Solar, Geocoding</p>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section class="team-section" id="equipo">
      <div class="team-container">
        <h2 class="section-title" data-en='<i class="fas fa-users"></i> Our Team'>
          <i class="fas fa-users"></i> Nuestro Equipo
        </h2>
        <p class="section-subtitle" data-en="Meet the founders of GeoFeedback Chile">
          Conoce a los fundadores de GeoFeedback Chile
        </p>
        <div class="team-grid">
          <div class="team-card">
            <div class="team-avatar"><i class="fas fa-user"></i></div>
            <h3 class="team-name">Consuelo Sebastian Silva</h3>
            <p class="team-role" data-en="Founder">Fundadora</p>
            <a
              href="https://www.linkedin.com/in/consuelo-sebastian-silva-b15407342/"
              target="_blank"
              rel="noopener noreferrer"
              class="team-linkedin"
            >
              <i class="fab fa-linkedin"></i> Ver LinkedIn
            </a>
          </div>
          <div class="team-card">
            <div class="team-avatar"><i class="fas fa-user"></i></div>
            <h3 class="team-name">Alejandro Hernandez Aguirre</h3>
            <p class="team-role" data-en="Co-Founder">Co-Fundador</p>
            <a
              href="https://www.linkedin.com/in/alejandro-hern%C3%A1ndez-aguirre-bb8967246/"
              target="_blank"
              rel="noopener noreferrer"
              class="team-linkedin"
            >
              <i class="fab fa-linkedin"></i> Ver LinkedIn
            </a>
          </div>
        </div>
      </div>
    </section>
    <section class="hero">
      <div class="hero-content">
        <div class="hero-text">
          <h1 data-en-html="Democratizing <span>Territorial Intelligence</span>">Democratizando la <span>Inteligencia Territorial</span></h1>
          <p data-en="Open source platform that transforms satellite data into risk maps and water management tools for Chile.">
            Plataforma open source que transforma datos satelitales en mapas de
            riesgo y herramientas de gestion hidrica para Chile.
          </p>
          <div class="hero-buttons">
            <a href="#demo" class="btn btn-primary" data-en-html='<i class="fas fa-map-marked-alt"></i> Explore Demo'
              ><i class="fas fa-map-marked-alt"></i> Explorar Demo</a
            >
            <a
              href="https://github.com/theChosen16/Demo_geofeedback"
              target="_blank"
              rel="noopener noreferrer"
              class="btn btn-secondary"
              ><i class="fab fa-github"></i> GitHub</a
            >
          </div>
        </div>
        <div class="hero-visual">
          <div class="earth-atmosphere"></div>
           <!-- [NEW] Optimized Stats Widget Position - Top Left to avoid any overlap -->
          <div class="stats-widget" id="stats-widget" style="position: absolute; top: -50px; left: -20px; background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(15px); padding: 0.8rem 1.5rem; border-radius: 16px; border: 1px solid rgba(255, 255, 255, 0.1); z-index: 100; display: flex; gap: 2rem; box-shadow: 0 8px 32px rgba(0,0,0,0.4);">
              <div class="stat-item" style="text-align: center;">
                  <span id="stat-visits" style="display: block; font-size: 1.5rem; font-weight: 800; color: #10b981; text-shadow: 0 0 10px rgba(16, 185, 129, 0.3);">-</span>
                  <span style="font-size: 0.7rem; color: #94a3b8; text-transform: uppercase; font-weight: 600; letter-spacing: 1px;" data-en="Visits">Visitas</span>
              </div>
              <div class="stat-divider" style="width: 1px; background: rgba(255,255,255,0.1); align-self: stretch;"></div>
              <div class="stat-item" style="text-align: center;">
                  <span id="stat-analyses" style="display: block; font-size: 1.5rem; font-weight: 800; color: #3b82f6; text-shadow: 0 0 10px rgba(59, 130, 246, 0.3);">-</span>
                  <span style="font-size: 0.7rem; color: #94a3b8; text-transform: uppercase; font-weight: 600; letter-spacing: 1px;" data-en="Analyses">AnÃ¡lisis</span>
              </div>
          </div>

          <!-- Professional 3D Sphere (CSS) -->
           <div class="earth"></div>
           <!-- Removed Cartoon SVG -->


          <div class="earth-satellite-animation">
            <!-- Stars Background -->
            <div class="stars-container">
              <div class="star"></div>
              <div class="star"></div>
              <div class="star"></div>
              <div class="star"></div>
              <div class="star"></div>
              <div class="star"></div>
              <div class="star"></div>
              <div class="star"></div>
            </div>

            <!-- Orbit Path -->
            <div class="orbit-path"></div>
            <!-- Professional 3D Satellite -->
            <div class="satellite-container">
                <div class="satellite-body-group">
                    <!-- Left Panel Group -->
                    <div class="solar-panel-group panel-left-group">
                        <div class="panel-face panel-front"></div>
                        <div class="panel-face panel-back"></div>
                    </div>
                    
                    <!-- Main Body Cube -->
                    <div class="sat-cube">
                        <div class="cube-face face-front"></div>
                        <div class="cube-face face-back"></div>
                        <div class="cube-face face-right"></div>
                        <div class="cube-face face-left"></div>
                        <div class="cube-face face-top"></div>
                        <div class="cube-face face-bottom"></div>
                    </div>

                    <!-- Right Panel Group -->
                    <div class="solar-panel-group panel-right-group">
                         <div class="panel-face panel-front"></div>
                         <div class="panel-face panel-back"></div>
                    </div>
                </div>
            </div>

            <!-- Data Points on Earth -->
            <div class="data-points">
              <div class="data-point"></div>
              <div class="data-point"></div>
              <div class="data-point"></div>
              <div class="data-point"></div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section id="problema" class="section section-dark">
      <div class="container">
        <div class="section-header">
          <h2 data-en="The Problem">El Problema</h2>
          <p data-en="Chile faces critical challenges in territorial management">Chile enfrenta desafios criticos en gestion territorial</p>
        </div>
        <div class="cards-grid">
          <div class="card">
            <i class="fas fa-balance-scale"></i>
            <h3 data-en="Law 21.364">Ley 21.364</h3>
            <p data-en="Municipalities must develop emergency plans and risk maps, but lack accessible tools.">
              Municipios deben elaborar planes de emergencia y mapas de riesgo,
              pero carecen de herramientas accesibles.
            </p>
          </div>
          <div class="card">
            <i class="fas fa-tint-slash"></i>
            <h3 data-en="Mega-drought">Mega-sequia</h3>
            <p data-en="15 years of water deficit. Farmers need data to optimize water use.">
              15 aÃ±os de deficit hidrico. Agricultores necesitan datos para
              optimizar uso del agua.
            </p>
          </div>
          <div class="card">
            <i class="fas fa-dollar-sign"></i>
            <h3 data-en="High Cost">Alto Costo</h3>
            <p data-en="Professional geospatial studies are expensive for rural municipalities.">
              Estudios geoespaciales profesionales son costosos para municipios
              rurales.
            </p>
          </div>
        </div>
      </div>
    </section>
    <section id="solucion" class="section section-light">
      <div class="container">
        <div class="section-header">
          <h2 data-en="Our Solution">Nuestra Solucion</h2>
          <p data-en="Territorial intelligence with Google Maps Platform + Google Earth Engine APIs">
            Inteligencia territorial con APIs de Google Maps Platform + Google
            Earth Engine
          </p>
        </div>

        <!-- API Category: Satellite -->
        <h3
          style="color: var(--primary); margin-bottom: 1rem; font-size: 1.2rem"
          data-en='<i class="fas fa-satellite" style="color: var(--secondary)"></i> Satellite Analysis'
        >
          <i class="fas fa-satellite" style="color: var(--secondary)"></i>
          Analisis Satelital
        </h3>
        <div class="cards-grid" style="margin-bottom: 2rem">
          <div class="card card-light">
            <i class="fab fa-google"></i>
            <h3>Google Earth Engine</h3>
            <p data-en="Sentinel-2 Processing (NDVI, NDWI, NDMI)">Procesamiento de Sentinel-2 (NDVI, NDWI, NDMI)</p>
          </div>
          <div class="card card-light">
            <i class="fas fa-th"></i>
            <h3>Map Tiles API</h3>
            <p data-en="Custom map tiles and overlays">Tiles de mapas personalizados y overlays</p>
          </div>
        </div>

        <!-- API Category: Location -->
        <h3
          style="color: var(--primary); margin-bottom: 1rem; font-size: 1.2rem"
          data-en-html='<i class="fas fa-location-dot" style="color: var(--secondary)"></i> Location and Places'
        >
          <i class="fas fa-location-dot" style="color: var(--secondary)"></i>
          Ubicacion y Lugares
        </h3>
        <div class="cards-grid" style="margin-bottom: 2rem">
          <div class="card card-light">
            <i class="fas fa-location-arrow"></i>
            <h3>Geocoding API</h3>
            <p data-en="Address to coordinate conversion">Conversion direccion a coordenadas</p>
          </div>
          <div class="card card-light">
            <i class="fas fa-location-crosshairs"></i>
            <h3>Geolocation API</h3>
            <p data-en="Real-time user location">Ubicacion del usuario en tiempo real</p>
          </div>
          <div class="card card-light">
            <i class="fas fa-building"></i>
            <h3>Places API (New)</h3>
            <p data-en="Places and infrastructure search">Busqueda de lugares e infraestructura</p>
          </div>
          <div class="card card-light">
            <i class="fas fa-check-circle"></i>
            <h3>Address Validation</h3>
            <p data-en="Postal address validation">Validacion de direcciones postales</p>
          </div>
        </div>

        <!-- API Category: Analysis -->
        <h3
          style="color: var(--primary); margin-bottom: 1rem; font-size: 1.2rem"
          data-en-html='<i class="fas fa-chart-line" style="color: var(--secondary)"></i> Analysis APIs'
        >
          <i class="fas fa-chart-line" style="color: var(--secondary)"></i> APIs
          de Analisis
        </h3>
        <div class="cards-grid" style="margin-bottom: 2rem">
          <div class="card card-light">
            <i class="fas fa-mountain"></i>
            <h3>Elevation API</h3>
            <p>Datos topograficos en tiempo real</p>
          </div>
          <div class="card card-light">
            <i class="fas fa-wind"></i>
            <h3>Air Quality API</h3>
            <p>Calidad del aire resolucion 500m</p>
          </div>
          <div class="card card-light">
            <i class="fas fa-sun"></i>
            <h3>Solar API</h3>
            <p>Potencial fotovoltaico de cubiertas</p>
          </div>
          <div class="card card-light">
            <i class="fas fa-leaf"></i>
            <h3>Pollen API</h3>
            <p>Niveles de polen y alergenos</p>
          </div>
        </div>

        <!-- API Category: Visualization -->
        <h3
          style="color: var(--primary); margin-bottom: 1rem; font-size: 1.2rem"
        >
          <i class="fas fa-map" style="color: var(--secondary)"></i>
          Visualizacion
        </h3>
        <div class="cards-grid">
          <div class="card card-light">
            <i class="fas fa-map-marked-alt"></i>
            <h3>Maps JavaScript API</h3>
            <p>Mapas interactivos web</p>
          </div>
          <div class="card card-light">
            <i class="fas fa-image"></i>
            <h3>Maps Static API</h3>
            <p>Mapas estaticos para reportes PDF</p>
          </div>
          <div class="card card-light">
            <i class="fas fa-database"></i>
            <h3>Maps Datasets API</h3>
            <p>Gestion de datasets geoespaciales</p>
          </div>
        </div>
      </div>
    </section>
    <section id="indices" class="section section-dark">
      <div class="container">
        <div class="section-header">
          <h2>Indices Satelitales Sentinel-2</h2>
          <p>Comprendiendo los datos que analizamos</p>
        </div>
        <div class="cards-grid">
          <div class="card">
            <i class="fas fa-leaf"></i>
            <h3 data-en="NDVI - Vegetation Index">NDVI - Indice de Vegetacion</h3>
            <p data-en-html="<strong>Formula:</strong> (NIR - Red) / (NIR + Red)"><strong>Formula:</strong> (NIR - Rojo) / (NIR + Rojo)</p>
            <p><strong>Bandas:</strong> (B8 - B4) / (B8 + B4)</p>
            <p><strong>Rango:</strong> -1 a +1</p>
            <p data-en="Values > 0.3 indicate healthy vegetation. Used to monitor crop health and vegetation cover.">
              Valores &gt; 0.3 indican vegetacion saludable. Usado para
              monitorear salud de cultivos y cobertura vegetal.
            </p>
          </div>
          <div class="card">
            <i class="fas fa-water"></i>
            <h3 data-en="NDWI - Water Index">NDWI - Indice de Agua</h3>
            <p data-en-html="<strong>Formula:</strong> (Green - NIR) / (Green + NIR)"><strong>Formula:</strong> (Verde - NIR) / (Verde + NIR)</p>
            <p><strong>Bandas:</strong> (B3 - B8) / (B3 + B8)</p>
            <p><strong>Rango:</strong> -1 a +1</p>
            <p data-en="Values > 0.3 indicate water presence. Detects water bodies, floods, and surface moisture.">
              Valores &gt; 0.3 indican presencia de agua. Detecta cuerpos de
              agua, inundaciones y humedad superficial.
            </p>
          </div>
          <div class="card">
            <i class="fas fa-tint"></i>
            <h3 data-en="NDMI - Moisture Index">NDMI - Indice de Humedad</h3>
            <p data-en-html="<strong>Formula:</strong> (NIR - SWIR) / (NIR + SWIR)"><strong>Formula:</strong> (NIR - SWIR) / (NIR + SWIR)</p>
            <p><strong>Bandas:</strong> (B8 - B11) / (B8 + B11)</p>
            <p><strong>Rango:</strong> -1 a +1</p>
            <p data-en="Values > 0.2 indicate high moisture. Evaluates water stress in vegetation.">
              Valores &gt; 0.2 indican alta humedad. Evalua estres hidrico en
              vegetacion y contenido de agua en plantas.
            </p>
          </div>
        </div>

        <!-- Science Explainer Box with Animations -->
        <div class="science-explainer" style="margin-top: 2rem">
          <!-- Como funcionan los indices -->
          <div
            class="explainer-card"
            style="
              background: linear-gradient(
                135deg,
                rgba(45, 90, 74, 0.15) 0%,
                rgba(0, 0, 0, 0.3) 100%
              );
              border-radius: 16px;
              padding: 1.5rem;
              margin-bottom: 1.5rem;
              animation: fadeInUp 0.6s ease-out;
            "
          >
            <h4
              style="
                color: var(--secondary);
                margin-bottom: 1rem;
                display: flex;
                align-items: center;
                gap: 0.5rem;
              "
              data-en='<i class="fas fa-lightbulb" style="animation: pulse 2s infinite"></i> How do these indices work?'
            >
              <i
                class="fas fa-lightbulb"
                style="animation: pulse 2s infinite"
              ></i>
              Â¿Como funcionan estos indices?
            </h4>
            <p style="line-height: 1.8; font-size: 1rem; color: #e0e0e0">
              Imagina que cada material en la Tierra tiene su propia "huella
              digital" de luz. Las plantas, el agua y el suelo reflejan y
              absorben diferentes colores de forma unica.
              <br /><br />
              <strong style="color: var(--secondary)"
                >ðŸŒ¿ Las plantas sanas</strong
              >
              absorben la luz roja para hacer fotosintesis, pero reflejan
              intensamente la luz infrarroja (invisible para nosotros). Es como
              si las plantas "brillaran" en infrarrojo cuando estan sanas.
              <br /><br />
              <strong style="color: #3b82f6">ðŸ’§ El agua</strong> absorbe casi
              toda la luz infrarroja, pero refleja algo de luz verde. Por eso
              podemos detectar lagos, rios e inundaciones desde el espacio.
              <br /><br />
              <strong style="color: #06b6d4"
                >ðŸ’¦ La humedad en las plantas</strong
              >
              absorbe un tipo especial de infrarrojo (SWIR). Cuando las plantas
              tienen sed, esta "firma" cambia, permitiendonos detectar estres
              hidrico antes de que sea visible.
            </p>
          </div>

          <!-- Sentinel-2 Info -->
          <div
            class="explainer-card"
            style="
              background: linear-gradient(
                135deg,
                rgba(59, 130, 246, 0.1) 0%,
                rgba(0, 0, 0, 0.3) 100%
              );
              border-radius: 16px;
              padding: 1.5rem;
              animation: fadeInUp 0.8s ease-out;
            "
          >
            <h4
              style="
                color: #60a5fa;
                margin-bottom: 1rem;
                display: flex;
                align-items: center;
                gap: 0.5rem;
              "
              data-en='<i class="fas fa-satellite" style="animation: float 3s ease-in-out infinite"></i> Sentinel-2: Our eyes in space'
            >
              <i
                class="fas fa-satellite"
                style="animation: float 3s ease-in-out infinite"
              ></i>
              Sentinel-2: Nuestros ojos en el espacio
            </h4>
            <div
              style="
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 1rem;
                margin-bottom: 1rem;
              "
            >
              <div
                style="
                  background: rgba(0, 0, 0, 0.2);
                  padding: 1rem;
                  border-radius: 8px;
                  text-align: center;
                "
              >
                <div
                  style="
                    font-size: 1.8rem;
                    color: var(--secondary);
                    font-weight: bold;
                  "
                >
                  ðŸ‡ªðŸ‡º
                </div>
                <div style="font-size: 0.85rem; color: #aaa">
                  Operado por ESA<br />(Agencia Espacial Europea)
                </div>
              </div>
              <div
                style="
                  background: rgba(0, 0, 0, 0.2);
                  padding: 1rem;
                  border-radius: 8px;
                  text-align: center;
                "
              >
                <div
                  style="
                    font-size: 1.8rem;
                    color: var(--secondary);
                    font-weight: bold;
                  "
                >
                  â‚¬200M
                </div>
                <div style="font-size: 0.85rem; color: #aaa">
                  Costo por satelite<br />+ â‚¬25M/aÃ±o operacion
                </div>
              </div>
              <div
                style="
                  background: rgba(0, 0, 0, 0.2);
                  padding: 1rem;
                  border-radius: 8px;
                  text-align: center;
                "
              >
                <div
                  style="
                    font-size: 1.8rem;
                    color: var(--secondary);
                    font-weight: bold;
                  "
                >
                  GRATIS
                </div>
                <div style="font-size: 0.85rem; color: #aaa">
                  Datos abiertos<br />para todo el mundo
                </div>
              </div>
            </div>
            <p style="font-size: 0.9rem; color: #9ca3af; line-height: 1.6">
              <i class="fas fa-info-circle"></i>
              Sentinel-2 captura 13 "colores" de luz (bandas espectrales). Para
              analisis aun mas detallados, la ESA esta desarrollando
              <strong>CHIME</strong>, un satelite hiperespectral con mas de 200
              bandas que funcionara como un laboratorio quimico en orbita.
            </p>
          </div>
        </div>

        <style>
          @keyframes fadeInUp {
            from {
              opacity: 0;
              transform: translateY(20px);
            }
            to {
              opacity: 1;
              transform: translateY(0);
            }
          }
          @keyframes pulse {
            0%,
            100% {
              opacity: 1;
            }
            50% {
              opacity: 0.5;
            }
          }
          @keyframes float {
            0%,
            100% {
              transform: translateY(0px);
            }
            50% {
              transform: translateY(-5px);
            }
          }
        </style>
      </div>
    </section>
    <section id="servicios" class="section section-dark">
      <div class="container">
        <div class="section-header">
          <h2>
            <i class="fas fa-rocket" style="color: var(--accent)"></i> Servicios
            Premium
          </h2>
          <p>
            Soluciones profesionales de inteligencia territorial para tu
            organizacion
          </p>
        </div>

        <!-- Planes de Suscripcion -->
        <h3 style="color: white; margin-bottom: 1.5rem; font-size: 1.3rem">
          <i class="fas fa-tags" style="color: var(--secondary)"></i> Planes de
          Suscripcion
        </h3>
        <div class="cards-grid" style="margin-bottom: 3rem">
          <div class="card" style="border: 2px solid rgba(255, 255, 255, 0.1)">
            <div style="text-align: center">
              <span
                style="
                  background: var(--secondary);
                  color: white;
                  padding: 0.25rem 0.75rem;
                  border-radius: 20px;
                  font-size: 0.8rem;
                  font-weight: 600;
                "
                data-en="MONITORING"
                >MONITOREO</span
              >
              <div style="font-size: 2rem; font-weight: 800; margin: 1rem 0">
                $700.000<span style="font-size: 0.9rem; font-weight: 400" data-en=" CLP/mo">
                  CLP/mes</span
                >
              </div>
            </div>
            <ul
              style="
                list-style: none;
                padding: 0;
                margin: 1rem 0;
                color: rgba(255, 255, 255, 0.8);
              "
            >
              <li style="padding: 0.5rem 0">
                <i
                  class="fas fa-check"
                  style="color: var(--secondary); margin-right: 0.5rem"
                ></i><strong data-en="GEE Commercial License">Licencia Comercial GEE</strong> <span data-en="included">incluida</span>
              </li>
              <li style="padding: 0.5rem 0">
                <i
                  class="fas fa-check"
                  style="color: var(--secondary); margin-right: 0.5rem"
                ></i><span data-en-html="Managed <strong>Google Cloud</strong> infrastructure">Infraestructura Google Cloud gestionada</span>
              </li>
              <li style="padding: 0.5rem 0">
                <i
                  class="fas fa-check"
                  style="color: var(--secondary); margin-right: 0.5rem"
                ></i><span data-en="Custom real-time dashboard">Dashboard en tiempo real personalizado</span>
              </li>
              <li style="padding: 0.5rem 0">
                <i
                  class="fas fa-check"
                  style="color: var(--secondary); margin-right: 0.5rem"
                ></i><span data-en="Email alerts">Alertas por email</span>
              </li>
              <li style="padding: 0.5rem 0">
                <i
                  class="fas fa-check"
                  style="color: var(--secondary); margin-right: 0.5rem"
                ></i><span data-en="Email support">Soporte por email</span>
              </li>
                >Alertas por email
              </li>
              <li style="padding: 0.5rem 0">
                <i
                  class="fas fa-check"
                  style="color: var(--secondary); margin-right: 0.5rem"
                ></i
                >Soporte por email
              </li>
            </ul>
            <a
              href="#contacto"
              class="btn btn-primary"
              style="width: 100%; justify-content: center"
              data-en="Start Now"
              >Comenzar</a
            >
          </div>

          <div
            class="card"
            style="
              border: 2px solid var(--secondary);
              transform: scale(1.05);
              position: relative;
            "
          >
            <div
                style="
                  position: absolute;
                  top: 0;
                  right: 1rem;
                  background: var(--accent);
                  color: white;
                  padding: 0.25rem 0.75rem;
                  border-radius: 0 0 8px 8px;
                  font-size: 0.7rem;
                  font-weight: 700;
                  z-index: 10;
                "
                data-en="MOST POPULAR"
              >
                MAS POPULAR
              </div>
            <div style="text-align: center">
              <span
                style="
                  background: linear-gradient(
                    135deg,
                    var(--secondary),
                    var(--accent)
                  );
                  color: white;
                  padding: 0.25rem 0.75rem;
                  border-radius: 20px;
                  font-size: 0.8rem;
                  font-weight: 600;
                "
                data-en="PROFESSIONAL"
                >PROFESIONAL</span
              >
              <div style="font-size: 2rem; font-weight: 800; margin: 1rem 0">
                $2.800.000<span style="font-size: 0.9rem; font-weight: 400" data-en=" CLP/mo">
                  CLP/mes</span
                >
              </div>
            </div>
            <ul
              style="
                list-style: none;
                padding: 0;
                margin: 1rem 0;
                color: rgba(255, 255, 255, 0.8);
              "
            >
              <li style="padding: 0.5rem 0">
                <i
                  class="fas fa-check"
                  style="color: var(--secondary); margin-right: 0.5rem"
                ></i
              <li style="padding: 0.5rem 0">
                <i
                  class="fas fa-check"
                  style="color: var(--secondary); margin-right: 0.5rem"
                ></i><strong data-en="High Computing Capacity">Alta Capacidad de CÃ³mputo</strong> (High-EECU)
              </li>
              <li style="padding: 0.5rem 0">
                <i
                  class="fas fa-check"
                  style="color: var(--secondary); margin-right: 0.5rem"
                ></i><strong data-en="Private Data Ingestion">Ingesta de Datos Privados</strong> (Drones/Satellite)
              </li>
              <li style="padding: 0.5rem 0">
                <i
                  class="fas fa-check"
                  style="color: var(--secondary); margin-right: 0.5rem"
                ></i><span data-en="Unlimited Full-Resolution export">ExportaciÃ³n Full-Resolution sin lÃ­mites</span>
              </li>
              <li style="padding: 0.5rem 0">
                <i
                  class="fas fa-check"
                  style="color: var(--secondary); margin-right: 0.5rem"
                ></i><span data-en="API to integrate data into your systems">API para integrar data a tus sistemas</span>
              </li>
              <li style="padding: 0.5rem 0">
                <i
                  class="fas fa-check"
                  style="color: var(--secondary); margin-right: 0.5rem"
                ></i><span data-en="Real-time alerts (email + SMS)">Alertas en tiempo real (email + SMS)</span>
              </li>
              <li style="padding: 0.5rem 0">
                <i
                  class="fas fa-check"
                  style="color: var(--secondary); margin-right: 0.5rem"
                ></i><span data-en="Automatic reports">Reportes automaticos</span>
              </li>
              <li style="padding: 0.5rem 0">
                <i
                  class="fas fa-check"
                  style="color: var(--secondary); margin-right: 0.5rem"
                ></i><span data-en="Priority support">Soporte prioritario</span>
              </li>
            </ul>
            <a
              href="#contacto"
              class="btn btn-primary"
              style="width: 100%; justify-content: center"
              data-en="Choose Plan"
              >Elegir Plan</a
            >
          </div>

          <div class="card" style="border: 2px solid rgba(255, 255, 255, 0.1)">
            <div style="text-align: center">
              <span
                style="
                  background: var(--primary-light);
                  color: white;
                  padding: 0.25rem 0.75rem;
                  border-radius: 20px;
                  font-size: 0.8rem;
                  font-weight: 600;
                "
                data-en="ENGINEERING"
                >INGENIERIA</span
              >
              <div style="font-size: 2rem; font-weight: 800; margin: 1rem 0" data-en="Contact Us">
                Contactar
              </div>
            </div>
            <ul
              style="
                list-style: none;
                padding: 0;
                margin: 1rem 0;
                color: rgba(255, 255, 255, 0.8);
              "
            >
              <li style="padding: 0.5rem 0">
                <i
                  class="fas fa-check"
                  style="color: var(--secondary); margin-right: 0.5rem"
                ></i><span data-en="Environmental Engineering Services">Servicios de Ingenieria Ambiental</span>
              </li>
              <li style="padding: 0.5rem 0">
                <i
                  class="fas fa-check"
                  style="color: var(--secondary); margin-right: 0.5rem"
                ></i><span data-en="Environmental Impact Studies (EIA/DIA)">Estudios de Impacto Ambiental (EIA/DIA)</span>
              </li>
              <li style="padding: 0.5rem 0">
                <i
                  class="fas fa-check"
                  style="color: var(--secondary); margin-right: 0.5rem"
                ></i><span data-en="Custom GIS Consulting">Consultoria GIS personalizada</span>
              </li>
              <li style="padding: 0.5rem 0">
                <i
                  class="fas fa-check"
                  style="color: var(--secondary); margin-right: 0.5rem"
                ></i><span data-en="Environmental compliance monitoring">Monitoreo de cumplimiento ambiental</span>
              </li>
              <li style="padding: 0.5rem 0">
                <i
                  class="fas fa-check"
                  style="color: var(--secondary); margin-right: 0.5rem"
                ></i><span data-en="Dedicated project manager">Gestor de proyecto dedicado</span>
              </li>
            </ul>
            <a
              href="#contacto"
              class="btn btn-secondary"
              style="width: 100%; justify-content: center"
              data-en="Contact"
              >Contactar</a
            >
          </div>
        </div>

        <!-- Why GEE Section -->
        <div style="background: rgba(255,255,255,0.05); padding: 2rem; border-radius: 16px; margin-bottom: 3rem; border-left: 4px solid var(--secondary);">
            <h4 style="color: white; margin-bottom: 1rem;" data-en-html='<i class="fas fa-info-circle"></i> Why GeoFeedback + Google Earth Engine?'><i class="fas fa-info-circle"></i> Â¿Por quÃ© GeoFeedback + Google Earth Engine?</h4>
            <p style="color: rgba(255,255,255,0.8); margin-bottom: 1rem;" data-en-html="Google Earth Engine (GEE) is free only for research. <strong>For commercial use, it requires expensive Enterprise licenses.</strong>">
                Google Earth Engine (GEE) es gratuito solo para investigaciÃ³n. <strong>Para uso comercial requiere licencias Enterprise costosas.</strong>
            </p>
            <p style="color: rgba(255,255,255,0.8); margin-bottom: 1rem;" data-en="GeoFeedback removes that barrier. By subscribing, you get legal and direct access to the power of GEE for your business, without complex contracts or your own infrastructure. We manage the Earth Engine Compute Units (EECU) and storage for you.">
                GeoFeedback elimina esa barrera. Al suscribirte, obtienes acceso legal y directo a la potencia de GEE para tu negocio, sin contratos complejos ni infraestructura propia. Nosotros gestionamos las Earth Engine Compute Units (EECU) y el almacenamiento por ti.
            </p>
            <p style="color: rgba(255,255,255,0.8); font-size: 0.9rem; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1rem;" data-en-html="Our prices (Monitoring 700k and Professional 2.8M) are based on the official cost of Google's commercial license (500k and 2M) plus 40% for management and infrastructure.">
                Nuestros precios (BÃ¡sico 700k y Profesional 2.8M) se basan en el costo oficial de la licencia comercial de Google (500k y 2M) mÃ¡s un 40% por gestiÃ³n e infraestructura.
                <br>
                <a href="https://cloud.google.com/earth-engine/pricing?hl=es_419&_gl=1*vvnvev*_ga*MzMwNjEwOTIyLjE3Njg5NTQ0NTI.*_ga_WH2QY8WWF5*czE3Njg5NTQ0NTEkbzEkZzEkdDE3Njg5NTQ1NjckajUzJGwwJGgw" target="_blank" style="color: var(--secondary); text-decoration: underline; margin-top: 0.5rem; display: inline-block;" data-en-html='<i class="fas fa-external-link-alt"></i> See Official Google Earth Engine Pricing'>
                    <i class="fas fa-external-link-alt"></i> Ver Precios Oficiales de Google Earth Engine
                </a>
            </p>
        </div>

        <!-- Servicios Profesionales -->
        <h3 style="color: white; margin-bottom: 1.5rem; font-size: 1.3rem">
          <i class="fas fa-leaf" style="color: var(--secondary)"></i> <span data-en="Environmental Engineering Services">Servicios de Ingenieria Ambiental</span>
        </h3>
        <div class="cards-grid" style="margin-bottom: 3rem">
          <div class="card">
            <i class="fas fa-file-alt"></i>
            <h3 data-en="Environmental Impact Assessment">Evaluacion de Impacto Ambiental</h3>
            <p data-en="Baseline studies with satellite imagery. Vegetation, water resources, and land use analysis for EIA and DIA.">
              Estudios de linea base con imagenes satelitales. Analisis de
              vegetacion, recursos hidricos y uso de suelo para EIA y DIA.
            </p>
          </div>
          <div class="card">
            <i class="fas fa-clipboard-check"></i>
            <h3 data-en="Compliance Monitoring">Monitoreo de Cumplimiento</h3>
            <p data-en="Follow-up on RCA and SEIA regulations. Early detection of non-compliance through temporal analysis of indices.">
              Seguimiento de RCA y normativas SEIA. Deteccion temprana de
              incumplimientos mediante analisis temporal de indices.
            </p>
          </div>
          <div class="card">
            <i class="fas fa-exclamation-triangle"></i>
            <h3 data-en="Natural Risk Management">Gestion de Riesgos Naturales</h3>
            <p data-en="Water risk, forest fire, and landslide maps. Predictive models with topographic and climatic data.">
              Mapas de riesgo hidrico, incendios forestales y deslizamientos.
              Modelos predictivos con datos topograficos y climaticos.
            </p>
          </div>
          <div class="card">
            <i class="fas fa-project-diagram"></i>
            <h3 data-en="Custom GIS Consulting">Consultoria GIS Personalizada</h3>
            <p data-en="Development of tailored geospatial solutions. Dashboards, automated reports, and integrations with existing systems.">
              Desarrollo de soluciones geoespaciales a medida. Dashboards,
              reportes automatizados e integraciones con sistemas existentes.
            </p>
          </div>
        </div>

        <!-- Dashboard Demo -->
        <h3 style="color: white; margin-bottom: 1.5rem; font-size: 1.3rem" data-en-html='<i class="fas fa-server" style="color: var(--secondary)"></i> Dashboard Example: Powered by Google Earth Engineâ„¢'>
          <i class="fas fa-server" style="color: var(--secondary)"></i>
          Ejemplo de Dashboard: Potenciado por Google Earth Engineâ„¢
        </h3>
        <p style="color: rgba(255,255,255,0.7); margin-bottom: 1.5rem; max-width: 800px;" data-en="We process petabytes of satellite data in seconds using Google cloud infrastructure. Access massive computing capacity without managing your own servers.">
            Procesamos petabytes de datos satelitales en segundos utilizando la infraestructura en la nube de Google. 
            Accede a capacidad de cÃ³mputo masiva sin gestionar servidores propios.
        </p>
        <div
          style="
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
          "
        >
          <div
            style="
              display: grid;
              grid-template-columns: repeat(4, 1fr);
              gap: 1rem;
              margin-bottom: 1.5rem;
            "
          >
            <div
              style="
                background: rgba(16, 185, 129, 0.2);
                padding: 1.25rem;
                border-radius: 12px;
                text-align: center;
              "
            >
              <div
                style="
                  font-size: 0.8rem;
                  color: rgba(255, 255, 255, 0.7);
                  margin-bottom: 0.5rem;
                "
                data-en="Processing (EECU)"
              >
                Procesamiento (EECU)
              </div>
              <div
                style="
                  font-size: 2rem;
                  font-weight: 700;
                  color: var(--secondary);
                "
              >
                98%
              </div>
            </div>
            <div
              style="
                background: rgba(59, 130, 246, 0.2);
                padding: 1.25rem;
                border-radius: 12px;
                text-align: center;
              "
            >
              <div
                style="
                  font-size: 0.8rem;
                  color: rgba(255, 255, 255, 0.7);
                  margin-bottom: 0.5rem;
                "
                data-en="Analysis Latency"
              >
                Latencia AnÃ¡lisis
              </div>
              <div style="font-size: 2rem; font-weight: 700; color: #3b82f6">
                120ms
              </div>
            </div>
            <div
              style="
                background: rgba(245, 158, 11, 0.2);
                padding: 1.25rem;
                border-radius: 12px;
                text-align: center;
              "
            >
              <div
                style="
                  font-size: 0.8rem;
                  color: rgba(255, 255, 255, 0.7);
                  margin-bottom: 0.5rem;
                "
                data-en="Images/sec"
              >
                ImÃ¡genes/seg
              </div>
              <div style="font-size: 2rem; font-weight: 700; color: #f59e0b">
                2.5k
              </div>
            </div>
            <div
              style="
                background: rgba(239, 68, 68, 0.2);
                padding: 1.25rem;
                border-radius: 12px;
                text-align: center;
              "
            >
              <div
                style="
                  font-size: 0.8rem;
                  color: rgba(255, 255, 255, 0.7);
                  margin-bottom: 0.5rem;
                "
                data-en="Risk Zones"
              >
                Zonas de Riesgo
              </div>
              <div style="font-size: 2rem; font-weight: 700; color: #ef4444">
                8
              </div>
            </div>
          </div>

          <!-- Alertas Demo -->
          <div
            style="
              border-top: 1px solid rgba(255, 255, 255, 0.1);
              padding-top: 1.5rem;
            "
          >
            <h4 style="color: white; margin-bottom: 1rem; font-size: 1rem" data-en-html='<i class="fas fa-bell" style="color: var(--accent)"></i> Latest Alerts'>
              <i class="fas fa-bell" style="color: var(--accent)"></i> Ultimas
              Alertas
            </h4>
            <div style="display: flex; flex-direction: column; gap: 0.75rem">
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: 1rem;
                  background: rgba(239, 68, 68, 0.15);
                  padding: 0.75rem 1rem;
                  border-radius: 8px;
                  border-left: 3px solid #ef4444;
                "
              >
                <i class="fas fa-exclamation-circle" style="color: #ef4444"></i>
                <div style="flex: 1">
                  <div
                    style="font-weight: 600; color: white; font-size: 0.9rem"
                    data-en="NDVI drop detected - North Sector"
                  >
                    Caida de NDVI detectada - Sector Norte
                  </div>
                  <div
                    style="font-size: 0.8rem; color: rgba(255, 255, 255, 0.6)"
                    data-en="2 hours ago - Possible drought or logging"
                  >
                    Hace 2 horas - Posible sequia o tala
                  </div>
                </div>
                <span
                  style="
                    background: #ef4444;
                    color: white;
                    padding: 0.2rem 0.5rem;
                    border-radius: 4px;
                    font-size: 0.7rem;
                  "
                  data-en="CRITICAL"
                  >CRITICO</span
                >
              </div>
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: 1rem;
                  background: rgba(245, 158, 11, 0.15);
                  padding: 0.75rem 1rem;
                  border-radius: 8px;
                  border-left: 3px solid #f59e0b;
                "
              >
                <i class="fas fa-water" style="color: #f59e0b"></i>
                <div style="flex: 1">
                  <div
                    style="font-weight: 600; color: white; font-size: 0.9rem"
                    data-en="NDWI Increase - Quebrada El Frances"
                  >
                    Incremento NDWI - Quebrada El Frances
                  </div>
                  <div
                    style="font-size: 0.8rem; color: rgba(255, 255, 255, 0.6)"
                    data-en="5 hours ago - Possible water accumulation"
                  >
                    Hace 5 horas - Posible acumulacion de agua
                  </div>
                </div>
                <span
                  style="
                    background: #f59e0b;
                    color: white;
                    padding: 0.2rem 0.5rem;
                    border-radius: 4px;
                    font-size: 0.7rem;
                  "
                  data-en="MODERATE"
                  >MODERADO</span
                >
              </div>
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: 1rem;
                  background: rgba(16, 185, 129, 0.15);
                  padding: 0.75rem 1rem;
                  border-radius: 8px;
                  border-left: 3px solid var(--secondary);
                "
              >
                <i
                  class="fas fa-check-circle"
                  style="color: var(--secondary)"
                ></i>
                <div style="flex: 1">
                  <div
                    style="font-weight: 600; color: white; font-size: 0.9rem"
                    data-en="Monitoring Completed - Coastal Area"
                  >
                    Monitoreo completado - Area Costera
                  </div>
                  <div
                    style="font-size: 0.8rem; color: rgba(255, 255, 255, 0.6)"
                    data-en="1 day ago - No anomalies detected"
                  >
                    Hace 1 dia - Sin anomalias detectadas
                  </div>
                </div>
                <span
                  style="
                    background: var(--secondary);
                    color: white;
                    padding: 0.2rem 0.5rem;
                    border-radius: 4px;
                    font-size: 0.7rem;
                  "
                  data-en="OK"
                  >OK</span
                >
              </div>
            </div>
          </div>
        </div>

        <div style="text-align: center; margin-top: 2rem">
          <a
            href="#contacto"
            class="btn btn-primary"
            style="font-size: 1.1rem; padding: 1rem 2rem"
            ><i class="fas fa-envelope"></i> <span data-en="Request Full Demo">Solicitar Demo Completa</span></a
          >
        </div>
      </div>
    </section>
    <section class="contact-section" id="contacto">
      <div class="contact-container">
        <h2 class="section-title" data-en='<i class="fas fa-envelope"></i> Contact Us'>
          <i class="fas fa-envelope"></i> Contactanos
        </h2>
        <p class="section-subtitle" data-en="Have a question or proposal? Write to us">
          Tienes alguna pregunta o propuesta? Escribenos
        </p>
        <form class="contact-form" id="contact-form">
          <div class="form-group">
            <label for="contact-name" data-en="Name *">Nombre *</label>
            <input
              type="text"
              id="contact-name"
              name="name"
              placeholder="Tu nombre completo"
              required
              autocomplete="name"
              data-en-placeholder="Your full name"
            />
          </div>
          <div class="form-group">
            <label for="contact-company" data-en="Company (optional)">Empresa (opcional)</label>
            <input
              type="text"
              id="contact-company"
              name="company"
              placeholder="Nombre de tu empresa"
              autocomplete="organization"
              data-en-placeholder="Company name"
            />
          </div>
          <div class="form-group">
            <label for="contact-email" data-en="Email *">Correo electronico *</label>
            <input
              type="email"
              id="contact-email"
              name="email"
              placeholder="tu@email.com"
              required
              autocomplete="email"
              data-en-placeholder="you@email.com"
            />
          </div>
          <div class="form-group">
            <label for="contact-message" data-en="Message *">Mensaje *</label>
            <textarea
              id="contact-message"
              name="message"
              placeholder="Describe tu solicitud o consulta..."
              required
              autocomplete="off"
              data-en-placeholder="Describe your request or question..."
            ></textarea>
          </div>
          <button type="submit" class="btn-submit" id="contact-submit" data-en='<i class="fas fa-paper-plane"></i> Send Message'>
            <i class="fas fa-paper-plane"></i> Enviar Mensaje
          </button>
          <div class="form-success" id="contact-success" data-en='<i class="fas fa-check-circle"></i> Message sent successfully. We will contact you soon.'>
            <i class="fas fa-check-circle"></i> Mensaje enviado exitosamente.
            Nos pondremos en contacto pronto.
          </div>
        </form>
      </div>
    </section>

    <footer>
      <div class="footer-content">
        <div class="footer-logo">
          <i class="fas fa-globe-americas"></i>GeoFeedback Chile
        </div>
        <div class="footer-links">
          <a href="#demo" data-en="Demo">Demo</a>
          <a href="/api/docs" data-en="API">API</a>
          <a
            href="https://github.com/theChosen16/Demo_geofeedback"
            target="_blank"
            rel="noopener noreferrer"
            data-en="GitHub"
            >GitHub</a
          >
        </div>
        <div class="social-links">
          <a
            href="https://github.com/theChosen16/Demo_geofeedback"
            target="_blank"
            rel="noopener noreferrer"
            ><i class="fab fa-github"></i
          ></a>
        </div>
      </div>
    </footer>

    <!-- Interpretation Modal -->
    <div class="modal-overlay" id="interpretation-modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 data-en-html='<i class="fas fa-info-circle"></i> Result Interpretation'>
            <i class="fas fa-info-circle"></i> Interpretacion de Resultados
          </h3>
          <button class="modal-close" onclick="closeModal()">&times;</button>
        </div>
        <div class="modal-body" id="modal-body">
          <!-- Content injected by JS -->
        </div>
      </div>
    </div>

    <!-- Chat Toggle Button -->
    <button
      class="chat-toggle-btn"
      onclick="toggleChat()"
      title="Hablar con Asistente IA"
      data-en-title="Talk to AI Assistant"
    >
      <i class="fas fa-robot"></i>
    </button>

    <!-- Chat Sidebar -->
    <div id="chat-sidebar" class="chat-sidebar">
      <div class="chat-header">
        <h4 data-en-html='<i class="fas fa-robot"></i> GeoFeedback Assistant'><i class="fas fa-robot"></i> Asistente GeoFeedback</h4>
        <button class="chat-close" onclick="toggleChat()">&times;</button>
      </div>
      <div id="chat-messages" class="chat-messages">
        <div class="chat-message assistant">
          <div class="message-bubble" data-en="Hello! I'm the GeoFeedback AI assistant. I can help you understand territorial analysis, explain satellite indices like NDVI or NDWI, or answer questions about the platform. How can I help you today?">
            Hola! Soy el asistente de IA de GeoFeedback. Puedo ayudarte a
            entender los analisis territoriales, explicar indices satelitales
            como NDVI o NDWI, o responder preguntas sobre la plataforma. Â¿En que
            puedo ayudarte?
          </div>
        </div>
      </div>
      <div class="chat-input-wrapper">
        <input
          type="text"
          id="chat-input"
          class="chat-input"
          placeholder="Escribe tu pregunta..."
          data-en-placeholder="Type your question..."
          onkeypress="if (event.key === 'Enter') sendChatMessage();"
        />
        <button class="chat-send" onclick="sendChatMessage()">
          <i class="fas fa-paper-plane"></i>
        </button>
      </div>
    </div>

    <script>
      var MAPS_API_KEY = "GOOGLE_MAPS_KEY_PLACEHOLDER";
      var map = null;
      var marker = null;
      var autocomplete = null;
      var selectedPlace = null;
      var selectedApproach = null;
      var selectedRadius = 2000; // Default 2km
      var isSatellite = true;
      var chatHistory = [];
      var analysisContext = {};

      var approaches = {
        mining: {
          name: "Mineria Sostenible",
          icon: "mountain",
          indices: [
            {
              name: "Vegetacion (NDVI)",
              api: "Sentinel-2",
              desc: "Monitoreo de impacto ambiental en flora.",
              color: "#2ecc71",
            },
            {
              name: "Agua (NDWI)",
              api: "Sentinel-2",
              desc: "Deteccion de cuerpos de agua y relaves.",
              color: "#3498db",
            },
            {
              name: "Pendiente",
              api: "Elevation",
              desc: "Analisis de estabilidad de terreno.",
              color: "#95a5a6",
            },
          ],
        },
        agriculture: {
          name: "Agroindustria Inteligente",
          icon: "seedling",
          indices: [
            {
              name: "Salud Cultivo (NDVI)",
              api: "Sentinel-2",
              desc: "Vigor y salud de la vegetacion.",
              color: "#2ecc71",
            },
            {
              name: "Estres Hidrico (NDMI)",
              api: "Sentinel-2",
              desc: "Contenido de humedad en cultivos.",
              color: "#1abc9c",
            },
            {
              name: "Solar",
              api: "Solar API",
              desc: "Potencial para riego solar.",
              color: "#f1c40f",
            },
          ],
        },
        energy: {
          name: "Energias Renovables",
          icon: "solar-panel",
          indices: [
            {
              name: "Irradiancia",
              api: "Solar API",
              desc: "Potencial solar fotovoltaico.",
              color: "#f1c40f",
            },
            {
              name: "Topografia",
              api: "Elevation",
              desc: "Analisis de sombras y pendiente.",
              color: "#95a5a6",
            },
            {
              name: "Infraestructura",
              api: "Places",
              desc: "Proximidad a redes electricas.",
              color: "#e74c3c",
            },
          ],
        },
        "real-estate": {
          name: "Desarrollo Inmobiliario",
          icon: "building",
          indices: [
            {
              name: "Constructibilidad",
              api: "Elevation",
              desc: "Pendientes aptas para construccion.",
              color: "#95a5a6",
            },
            {
              name: "Servicios",
              api: "Places",
              desc: "Cercania a colegios y salud.",
              color: "#e74c3c",
            },
            {
              name: "Calidad Aire",
              api: "Air Quality",
              desc: "Indices de contaminacion local.",
              color: "#1abc9c",
            },
            {
              name: "Riesgos",
              api: "Sentinel-2",
              desc: "Historial de inundaciones (NDWI).",
              color: "#3498db",
            },
          ],
        },
        "flood-risk": {
          name: "Riesgo de Inundacion",
          icon: "water",
          indices: [
            {
              name: "Cuerpos de Agua (NDWI)",
              api: "Sentinel-2",
              desc: "Deteccion de zonas inundables.",
              color: "#3498db",
            },
            {
              name: "Elevacion",
              api: "Elevation",
              desc: "Modelado de terreno.",
              color: "#95a5a6",
            },
          ],
        },
        "water-management": {
          name: "Gestion Hidrica",
          icon: "tint",
          indices: [
            {
              name: "Humedad Suelo (NDMI)",
              api: "Sentinel-2",
              desc: "Retencion de agua en suelo.",
              color: "#1abc9c",
            },
            {
              name: "NDWI",
              api: "Sentinel-2",
              desc: "Monitoreo de embalses.",
              color: "#3498db",
            },
          ],
        },
        environmental: {
          name: "Calidad Ambiental",
          icon: "leaf",
          indices: [
            {
              name: "Cobertura Vegetal (NDVI)",
              api: "Sentinel-2",
              desc: "Densidad de vegetacion.",
              color: "#2ecc71",
            },
            {
              name: "Calidad Aire",
              api: "Air Quality",
              desc: "Indices AQI en tiempo real.",
              color: "#e74c3c",
            },
          ],
        },
        "land-planning": {
          name: "Planificacion Territorial",
          icon: "map-marked-alt",
          indices: [
            {
              name: "Pendiente",
              api: "Elevation",
              desc: "Aptitud de uso de suelo.",
              color: "#95a5a6",
            },
            {
              name: "Uso Actual",
              api: "Sentinel-2",
              desc: "Clasificacion de cobertura.",
              color: "#f1c40f",
            },
          ],
        },
        "fire-risk": {
          name: "Riesgo de Incendio Forestal",
          icon: "fire",
          indices: [
            {
              name: "Vegetacion Seca (NDVI)",
              api: "Sentinel-2",
              desc: "Areas con baja humedad vegetal.",
              color: "#dc2626",
            },
            {
              name: "Humedad Vegetacion (NDMI)",
              api: "Sentinel-2",
              desc: "Contenido de agua en plantas.",
              color: "#f97316",
            },
            {
              name: "Pendiente",
              api: "Elevation",
              desc: "Dificultad de acceso para combate.",
              color: "#95a5a6",
            },
          ],
        },
      };

      async function loadGoogleMaps() {
        var script = document.createElement("script");
        script.src =
          "https://maps.googleapis.com/maps/api/js?key=" +
          MAPS_API_KEY +
          "&libraries=places,marker&callback=initMap&v=weekly&loading=async";
        script.async = true;
        script.defer = true;
        document.head.appendChild(script);
      }

      async function initMap() {
        if (!MAPS_API_KEY || MAPS_API_KEY.length < 20) {
          console.error("API Key no configurada o invalida");
          return;
        }

        // Import libraries
        // Import libraries
        // Import libraries
        const { Map } = await google.maps.importLibrary("maps");
        const { AdvancedMarkerElement } =
          await google.maps.importLibrary("marker");
        const { Place, PlaceAutocompleteElement } =
          await google.maps.importLibrary("places");

        map = new Map(document.getElementById("demo-map"), {
          center: { lat: -33.4489, lng: -70.6693 }, // Santiago
          zoom: 5,
          mapId: "3a20a11ffd93a81165e3538d", // GeoFeedback Demo Map ID
          mapTypeId: "hybrid",
          disableDefaultUI: false,
          zoomControl: true,
          mapTypeControl: false,
          streetViewControl: false,
          fullscreenControl: true,
        });

        // Map Click Listener
        map.addListener("click", async (e) => {
          const clickedLat = e.latLng.lat();
          const clickedLng = e.latLng.lng();

          // Reverse Geocoding to get name
          const geocoder = new google.maps.Geocoder();
          const response = await geocoder.geocode({
            location: { lat: clickedLat, lng: clickedLng },
          });

          let placeName = "UbicaciÃ³n seleccionada";
          if (response.results && response.results[0]) {
            placeName = response.results[0].formatted_address;
          }

          if (marker) marker.map = null;
          marker = new AdvancedMarkerElement({
            map: map,
            position: { lat: clickedLat, lng: clickedLng },
            title: placeName,
          });

          selectedPlace = {
            lat: clickedLat,
            lng: clickedLng,
            name: placeName,
          };
          console.log("Selected Place from click:", selectedPlace);

          // Update UI
          document.getElementById("location-name").textContent = placeName;
          document.getElementById("location-coords").textContent =
            clickedLat.toFixed(4) + ", " + clickedLng.toFixed(4);
          document.getElementById("status-location").classList.add("ready");
          document.getElementById("result-location").innerHTML =
            '<i class="fas fa-check-circle result-icon" style="color:var(--secondary)"></i><div class="result-content"><h4>' +
            placeName +
            "</h4><p>Seleccionado en mapa</p></div>";

          checkReadyState();

          // Fetch Live Data
          fetchElevationAndSlope(clickedLat, clickedLng);
          fetchAirQuality(clickedLat, clickedLng);
          fetchSolarPotential(clickedLat, clickedLng);
        });

        // Autocomplete setup (New Places API)
        const container = document.getElementById("autocomplete-container");
        container.innerHTML = "";

        const autocomplete = new PlaceAutocompleteElement();
        autocomplete.id = "pac-input";
        autocomplete.classList.add("controls");
        // Set attributes to try to satisfy browser warnings
        autocomplete.setAttribute("name", "place_search");
        container.appendChild(autocomplete);

        // Handler function to process the place selection
        const onPlaceSelect = async (event) => {
          console.log("Event fired:", event.type, event);

          let place = null;

          // Case 1: New PlaceAutocompleteElement (gmp-select) returns placePrediction
          if (event.placePrediction) {
            console.log("Found placePrediction, converting to Place...");
            place = event.placePrediction.toPlace();
          }
          // Case 2: Some versions might return event.place directly
          else if (event.place) {
            console.log("Found event.place");
            place = event.place;
          }
          // Case 3: Fallback to details
          else if (event.detail?.place) {
            place = event.detail.place;
          }
          // Case 4: Last resort, try getPlace()
          else if (typeof autocomplete.getPlace === "function") {
            try {
              place = autocomplete.getPlace();
              console.log("Retrieved via getPlace():", place);
            } catch (e) {
              console.warn("getPlace failed", e);
            }
          }

          if (!place) {
            console.warn("Could not retrieve Place object from event.");
            return;
          }

          try {
            // If it's a Place object from the new API, we MUST fetch fields
            // We check for fetchFields method to distinguish from legacy PlaceResult
            if (typeof place.fetchFields === "function") {
              console.log("Fetching fields for Place object...");
              await place.fetchFields({
                fields: [
                  "displayName",
                  "formattedAddress",
                  "location",
                  "viewport",
                ],
              });

              if (!place.location) {
                console.error("Place has no location after fetchFields");
                alert(
                  "La ubicaciÃ³n seleccionada no tiene coordenadas vÃ¡lidas.",
                );
                return;
              }

              handlePlaceSelection(
                place.location,
                place.displayName,
                place.viewport,
              );
            }
            // Legacy PlaceResult object (has geometry property directly)
            else if (place.geometry && place.geometry.location) {
              console.log("Using legacy PlaceResult object");
              handlePlaceSelection(
                place.geometry.location,
                place.name || place.formatted_address,
                place.geometry.viewport,
              );
            } else {
              console.error("Unknown Place object structure:", place);
            }
          } catch (err) {
            console.error("Error processing place:", err);
            alert("Error al procesar el lugar: " + err.message);
          }
        };

        // Add listeners for ALL potential event names to be safe
        autocomplete.addEventListener("gmp-places-select", onPlaceSelect);
        autocomplete.addEventListener("gmp-placeselect", onPlaceSelect);
        autocomplete.addEventListener("gmp-select", onPlaceSelect);

        // Fallback for "Enter" key without selection
        autocomplete.addEventListener("keydown", async (event) => {
          if (event.key === "Enter") {
            const text = autocomplete.value;
            console.log("Enter pressed in search box. Value:", text);

            // Allow a small delay to see if the select event fires first
            setTimeout(() => {
              // If no place is selected or the name doesn't match (rough check)
              // We check if selectedPlace is null OR if the current selected place name is different from input text
              // This prevents re-triggering if the user just hit enter on an already selected place
              if (
                !selectedPlace ||
                (selectedPlace.name !== text && text.length > 3)
              ) {
                console.log("Triggering manual Geocoding fallback for:", text);
                const geocoder = new google.maps.Geocoder();
                geocoder.geocode({ address: text }, (results, status) => {
                  if (status === "OK" && results[0]) {
                    console.log("Geocoding success:", results[0]);
                    handlePlaceSelection(
                      results[0].geometry.location,
                      results[0].formatted_address,
                      results[0].geometry.viewport,
                    );
                  } else {
                    console.warn("Geocoding failed or no results for:", text);
                  }
                });
              }
            }, 500); // Increased delay to 500ms to ensure gmp-places-select has time to fire
          }
        });

        function handlePlaceSelection(location, name, viewport) {
          if (!location) {
            window.alert("No se encontraron detalles de ubicaciÃ³n.");
            return;
          }

          if (viewport) {
            map.fitBounds(viewport);
          } else {
            map.setCenter(location);
            map.setZoom(15);
          }

          if (marker) marker.map = null;
          marker = new AdvancedMarkerElement({
            map: map,
            position: location,
            title: name,
          });

          selectedPlace = {
            lat: location.lat(),
            lng: location.lng(),
            name: name,
          };
          console.log("Selected Place updated:", selectedPlace);

          // Update UI
          document.getElementById("location-name").textContent = name;
          document.getElementById("location-coords").textContent =
            selectedPlace.lat.toFixed(4) + ", " + selectedPlace.lng.toFixed(4);
          document.getElementById("status-location").classList.add("ready");
          document.getElementById("result-location").innerHTML =
            '<i class="fas fa-check-circle result-icon" style="color:var(--secondary)"></i><div class="result-content"><h4>' +
            name +
            "</h4><p>Ubicacion confirmada</p></div>";

          // Enable analysis button
          checkReadyState();

          // Fetch Live Data
          fetchElevationAndSlope(selectedPlace.lat, selectedPlace.lng);
          fetchAirQuality(selectedPlace.lat, selectedPlace.lng);
          fetchSolarPotential(selectedPlace.lat, selectedPlace.lng);
        }
      }

      function fetchElevationAndSlope(lat, lng) {
        var elevator = new google.maps.ElevationService();
        var locations = [];
        // Center and 4 surrounding points (~100m offset)
        var offset = 0.001;
        locations.push({ lat: lat, lng: lng });
        locations.push({ lat: lat + offset, lng: lng });
        locations.push({ lat: lat - offset, lng: lng });
        locations.push({ lat: lat, lng: lng + offset });
        locations.push({ lat: lat, lng: lng - offset });

        elevator.getElevationForLocations(
          { locations: locations },
          function (results, status) {
            if (status === "OK") {
              if (results[0]) {
                var centerElev = results[0].elevation;
                document.getElementById("data-elevation").textContent =
                  Math.round(centerElev) + " m";

                // Calculate max slope
                var maxDiff = 0;
                for (var i = 1; i < results.length; i++) {
                  var diff = Math.abs(results[i].elevation - centerElev);
                  if (diff > maxDiff) {
                    maxDiff = diff;
                  }
                }
                var slopePercent = (maxDiff / 111) * 100; // Rough approx
                var slopeClass =
                  slopePercent < 5
                    ? "Plano"
                    : slopePercent < 15
                      ? "Suave"
                      : slopePercent < 30
                        ? "Moderado"
                        : "Pronunciado";
                document.getElementById("data-slope").textContent =
                  Math.round(slopePercent) + "% (" + slopeClass + ")";
              } else {
                document.getElementById("data-elevation").textContent = "N/D";
                document.getElementById("data-slope").textContent = "N/D";
              }
            } else {
              document.getElementById("data-elevation").textContent = "Error";
              document.getElementById("data-slope").textContent = "Error";
            }
          },
        );
      }

      function fetchAirQuality(lat, lng) {
        var url =
          "https://airquality.googleapis.com/v1/currentConditions:lookup?key=" +
          MAPS_API_KEY;
        fetch(url, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ location: { latitude: lat, longitude: lng } }),
        })
          .then(function (response) {
            return response.json();
          })
          .then(function (data) {
            if (data.indexes && data.indexes.length > 0) {
              var aqi = data.indexes[0];
              var color =
                aqi.aqi <= 50
                  ? "#10b981"
                  : aqi.aqi <= 100
                    ? "#f59e0b"
                    : "#ef4444";
              document.getElementById("data-aqi").innerHTML =
                '<span style="color:' +
                color +
                '">' +
                aqi.aqi +
                " (" +
                aqi.category +
                ")</span>";
            } else {
              document.getElementById("data-aqi").textContent = "N/D";
            }
          })
          .catch(function () {
            document.getElementById("data-aqi").textContent = "N/D";
          });
      }

      function fetchSolarPotential(lat, lng) {
        var url =
          "https://solar.googleapis.com/v1/buildingInsights:findClosest?location.latitude=" +
          lat +
          "&location.longitude=" +
          lng +
          "&requiredQuality=LOW&key=" +
          MAPS_API_KEY;
        fetch(url)
          .then(function (response) {
            if (response.status === 404) {
              throw new Error("No solar data");
            }
            return response.json();
          })
          .then(function (data) {
            if (data.solarPotential) {
              var hours = Math.round(
                data.solarPotential.maxSunshineHoursPerYear || 0,
              );
              document.getElementById("data-solar").textContent =
                hours + " hrs/yr";
            } else {
              document.getElementById("data-solar").textContent =
                "Sin edificio";
            }
          })
          .catch(function (err) {
            console.log("Solar API info:", err.message);
            document.getElementById("data-solar").textContent = "N/D";
          });
      }

      function onApproachChange() {
        var select = document.getElementById("approach-select");
        var value = select.value;
        if (!value) {
          selectedApproach = null;
          document.getElementById("indices-panel").classList.remove("active");
          document.getElementById("status-approach").classList.remove("ready");
          checkReadyState();
          return;
        }
        selectedApproach = value;
        var config = approaches[value];
        document.getElementById("status-approach").classList.add("ready");
        var html = "";
        for (var i = 0; i < config.indices.length; i++) {
          var idx = config.indices[i];
          html +=
            '<div class="index-item"><div class="index-header"><div class="index-color" style="background:' +
            idx.color +
            '"></div><span class="index-name">' +
            idx.name +
            '</span><span class="index-api">' +
            idx.api +
            '</span></div><div class="index-desc">' +
            idx.desc +
            "</div></div>";
        }
        document.getElementById("indices-list").innerHTML = html;

        // Hide previous results if any
        var resultsContainer = document.getElementById("analysis-results");
        if (resultsContainer) {
          resultsContainer.style.display = "none";
          resultsContainer.innerHTML = "";
        }

        document.getElementById("indices-panel").classList.add("active");
        var resultEl = document.getElementById("result-approach");
        resultEl.innerHTML =
          '<i class="fas fa-' +
          config.icon +
          ' result-icon"></i><div class="result-content"><h4>' +
          config.name +
          "</h4><p>" +
          config.indices.length +
          " capas de datos</p></div>";
        checkReadyState();
      }

      function onRadiusChange() {
        var select = document.getElementById("radius-select");
        var value = select.value;
        if (!value) {
          selectedRadius = null;
        } else {
          selectedRadius = parseInt(value);
        }
        checkReadyState();
      }

      function checkReadyState() {
        var btn = document.getElementById("analyze-btn");
        btn.disabled = !(selectedPlace && selectedApproach && selectedRadius);

        // Update button text to show what's missing
        var missing = [];
        if (!selectedPlace) missing.push("ubicaciÃ³n");
        if (!selectedApproach) missing.push("enfoque");
        if (!selectedRadius) missing.push("radio");

        var hint = document.querySelector("#analyze-btn + p");
        if (hint) {
          if (missing.length > 0) {
            hint.textContent = "Requiere: " + missing.join(", ");
          } else {
            hint.textContent = "âœ“ Listo para analizar";
            hint.style.color = "var(--secondary)";
          }
        }
      }

      function centerMap() {
        if (map) {
          map.setCenter({ lat: -33.4489, lng: -70.6693 });
          map.setZoom(5);
        }
      }

      function toggleMapType() {
        if (map) {
          isSatellite = !isSatellite;
          map.setMapTypeId(isSatellite ? "hybrid" : "roadmap");
        }
      }

      function addMapLegend() {
        // Remove existing legend if any
        removeMapLegend();

        var legendDiv = document.createElement("div");
        legendDiv.id = "fire-risk-legend";
        legendDiv.style.cssText =
          "position:absolute; bottom:30px; left:10px; background:rgba(255,255,255,0.95); padding:12px 16px; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.25); font-family:Inter,sans-serif; z-index:1000; max-width:200px;";

        var title = document.createElement("div");
        title.textContent = "Riesgo de Incendio";
        title.style.cssText =
          "font-weight:600; font-size:0.85rem; margin-bottom:8px; color:#1e3a5f;";
        legendDiv.appendChild(title);

        var scale = [
          { color: "#22c55e", label: "Bajo" },
          { color: "#84cc16", label: "Moderado" },
          { color: "#eab308", label: "Alto" },
          { color: "#f97316", label: "Muy Alto" },
          { color: "#dc2626", label: "Extremo" },
        ];

        for (var i = 0; i < scale.length; i++) {
          var item = document.createElement("div");
          item.style.cssText =
            "display:flex; align-items:center; margin:4px 0; font-size:0.75rem;";

          var colorBox = document.createElement("div");
          colorBox.style.cssText =
            "width:20px; height:14px; background:" +
            scale[i].color +
            "; border-radius:3px; margin-right:8px;";

          var label = document.createElement("span");
          label.textContent = scale[i].label;
          label.style.color = "#374151";

          item.appendChild(colorBox);
          item.appendChild(label);
          legendDiv.appendChild(item);
        }

        document.getElementById("demo-map").appendChild(legendDiv);
      }

      function removeMapLegend() {
        var existing = document.getElementById("fire-risk-legend");
        if (existing) {
          existing.remove();
        }
      }

      var currentGeeLayer = null;

      function analyzeTerritory() {
        if (!selectedPlace || !selectedApproach) {
          return;
        }

        var btn = document.getElementById("analyze-btn");
        btn.innerHTML = '<span class="loading-spinner"></span> Procesando...';
        btn.disabled = true;

        var payload = {
          lat: selectedPlace.lat,
          lng: selectedPlace.lng,
          approach: selectedApproach,
          radius: selectedRadius,
        };

        fetch("/api/v1/analyze", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload),
        })
          .then((response) => response.json())
          .then((data) => {
            btn.innerHTML =
              '<i class="fas fa-satellite-dish"></i> Iniciar Analisis';
            btn.disabled = false;

            if (data.status === "success") {
              // Create Results Table
              var tableHtml =
                '<table class="results-table" style="width:100%; border-collapse:collapse; margin-top:10px; font-size:0.9rem;">';
              tableHtml +=
                '<thead><tr style="background:var(--primary-light); color:white;"><th style="padding:8px; text-align:left;">MÃ©trica</th><th style="padding:8px; text-align:right;">Valor</th></tr></thead><tbody>';

              for (var key in data.data) {
                tableHtml +=
                  '<tr style="border-bottom:1px solid #eee;"><td style="padding:8px;">' +
                  key +
                  '</td><td style="padding:8px; text-align:right; font-weight:600;">' +
                  data.data[key] +
                  "</td></tr>";
              }
              tableHtml += "</tbody></table>";

              // Add area info
              var areaKm2 = (data.area_m2 / 1000000).toFixed(2);
              var areaInfo =
                '<div style="margin-top:0.5rem; padding:0.5rem; background:#f8fafc; border-radius:6px; font-size:0.8rem; color:var(--text-light);">' +
                '<i class="fas fa-ruler-combined"></i> Area de analisis: <strong>' +
                data.area_m2.toLocaleString() +
                " mÂ²</strong> (" +
                areaKm2 +
                " kmÂ²) | Radio: " +
                (data.meta.buffer_radius_m || 1000) +
                "m" +
                "</div>";

              // Display in Analysis Results Container
              var resultsContainer =
                document.getElementById("analysis-results");
              if (!resultsContainer) {
                resultsContainer = document.createElement("div");
                resultsContainer.id = "analysis-results";
                resultsContainer.style.marginBottom = "1rem";
                var indicesPanel = document.getElementById("indices-panel");
                indicesPanel.insertBefore(
                  resultsContainer,
                  document.getElementById("indices-list"),
                );
              }

              resultsContainer.innerHTML =
                '<div class="result-box" style="background:white; border:1px solid var(--secondary); border-radius:8px; padding:1rem; box-shadow:0 2px 4px rgba(0,0,0,0.05);">' +
                '<h4 style="color:var(--primary); margin-top:0; margin-bottom:0.5rem; border-bottom:1px solid #eee; padding-bottom:0.5rem;"><i class="fas fa-chart-bar"></i> Resultados del AnÃ¡lisis</h4>' +
                tableHtml +
                areaInfo +
                '<button onclick="showInterpretationModal()" style="margin-top:1rem; width:100%;" class="btn btn-secondary"><i class="fas fa-info-circle"></i> Ver Escalas</button>' +
                "</div>";
              resultsContainer.style.display = "block";

              // Store FULL data for AI interpretation
              window.lastAnalysisData = data.data;
              window.lastApproach = selectedApproach;
              window.lastAnalysisMeta = data.meta;
              window.lastAnalysisArea = data.area_m2;

              // Scroll to results
              resultsContainer.scrollIntoView({
                behavior: "smooth",
                block: "start",
              });

              // Add GEE layer to map
              if (data.map_layer && data.map_layer.url) {
                if (currentGeeLayer) {
                  map.overlayMapTypes.removeAt(0);
                }

                var geeMapType = new google.maps.ImageMapType({
                  getTileUrl: function (coord, zoom) {
                    var url = data.map_layer.url;
                    url = url
                      .replace("{x}", coord.x)
                      .replace("{y}", coord.y)
                      .replace("{z}", zoom);
                    return url;
                  },
                  tileSize: new google.maps.Size(256, 256),
                  name: "GEE Layer",
                  opacity: 0.7,
                });

                map.overlayMapTypes.insertAt(0, geeMapType);
                currentGeeLayer = geeMapType;
                console.log("Capa GEE agregada: " + data.map_layer.url);

                // AÃ±adir leyenda de colores si es fire-risk
                if (selectedApproach === "fire-risk") {
                  addMapLegend();
                } else {
                  removeMapLegend();
                }
              }

              // Open Chat Sidebar with AI Interpretation
              var locationName = selectedPlace
                ? selectedPlace.name
                : "la ubicaciÃ³n seleccionada";
              analysisContext = {
                approach: selectedApproach,
                results: data.data,
                meta: data.meta,
                area_m2: data.area_m2,
                location: locationName,
              };

              // Open interpretation modal with AI analysis
              showInterpretationModal();
            } else if (data.status === "warning") {
              alert("Aviso: " + data.message);
            } else {
              alert("Error en el analisis: " + data.message);
            }
          })
          .catch((error) => {
            console.error("Error:", error);
            btn.innerHTML =
              '<i class="fas fa-satellite-dish"></i> Iniciar Analisis';
            btn.disabled = false;
            alert("Error de conexiÃ³n. Por favor intenta de nuevo.");
          });
      }

      function showInterpretationModal() {
        var data = window.lastAnalysisData || {};
        var approach = window.lastApproach || "";
        var modalBody = document.getElementById("modal-body");
        var html = "";

        // Extract numeric values for interpretation
        var ndvi = parseFloat(
          Object.values(data).find(
            (v) =>
              v &&
              v.toString().match(/^-?\d+\.\d+$/) &&
              parseFloat(v) >= -1 &&
              parseFloat(v) <= 1,
          ) || 0,
        );

        // NDVI Scale (if applicable)
        if (
          approach === "mining" ||
          approach === "agriculture" ||
          approach === "environmental"
        ) {
          var ndviVal = 0;
          for (var k in data) {
            if (
              k.toLowerCase().includes("ndvi") ||
              k.toLowerCase().includes("vegetac")
            ) {
              ndviVal = parseFloat(data[k]) || 0;
              break;
            }
          }
          var ndviInterp =
            ndviVal > 0.6
              ? "Vegetacion densa y saludable. Excelente cobertura vegetal."
              : ndviVal > 0.3
                ? "Vegetacion moderada. Cobertura vegetal aceptable."
                : ndviVal > 0.1
                  ? "Vegetacion escasa o con estres. Requiere atencion."
                  : "Sin vegetacion significativa o superficie construida/agua.";

          html +=
            '<div class="scale-section">' +
            '<div class="scale-title"><i class="fas fa-leaf" style="color:#22c55e"></i> Indice de Vegetacion (NDVI) <span class="value-badge">' +
            ndviVal.toFixed(2) +
            "</span></div>" +
            '<div class="scale-bar ndvi"></div>' +
            '<div class="scale-labels"><span>-1 (Agua)</span><span>0 (Suelo)</span><span>+1 (Vegetacion densa)</span></div>' +
            '<div class="interpretation-text">' +
            ndviInterp +
            "</div>" +
            "</div>";
        }

        // NDWI Scale (if applicable)
        if (
          approach === "flood-risk" ||
          approach === "water-management" ||
          approach === "mining"
        ) {
          var ndwiVal = 0;
          for (var k in data) {
            if (
              k.toLowerCase().includes("ndwi") ||
              k.toLowerCase().includes("agua")
            ) {
              ndwiVal = parseFloat(data[k]) || 0;
              break;
            }
          }
          var ndwiInterp =
            ndwiVal > 0.3
              ? "Alta presencia de agua. Zona de cuerpo de agua o saturacion."
              : ndwiVal > 0
                ? "Humedad moderada. Suelo humedo o vegetacion con agua."
                : ndwiVal > -0.3
                  ? "Baja humedad. Suelo seco o vegetacion seca."
                  : "Muy seco. Suelo arido o superficie urbana.";

          html +=
            '<div class="scale-section">' +
            '<div class="scale-title"><i class="fas fa-water" style="color:#3b82f6"></i> Indice de Agua (NDWI) <span class="value-badge">' +
            ndwiVal.toFixed(2) +
            "</span></div>" +
            '<div class="scale-bar ndwi"></div>' +
            '<div class="scale-labels"><span>-1 (Seco)</span><span>0</span><span>+1 (Agua)</span></div>' +
            '<div class="interpretation-text">' +
            ndwiInterp +
            "</div>" +
            "</div>";
        }

        // Slope Scale (if applicable)
        if (
          approach === "real-estate" ||
          approach === "energy" ||
          approach === "land-planning" ||
          approach === "mining"
        ) {
          var slopeVal = 0;
          for (var k in data) {
            if (
              k.toLowerCase().includes("pendiente") ||
              k.toLowerCase().includes("slope")
            ) {
              slopeVal = parseFloat(data[k]) || 0;
              break;
            }
          }
          var slopeInterp =
            slopeVal < 5
              ? "Terreno plano. Ideal para construccion y agricultura mecanizada."
              : slopeVal < 15
                ? "Pendiente suave. Apto para la mayoria de usos con algunas consideraciones."
                : slopeVal < 30
                  ? "Pendiente moderada. Requiere terrazas o muros de contencion."
                  : "Pendiente pronunciada. Alto riesgo de erosion, no apto para construccion convencional.";

          html +=
            '<div class="scale-section">' +
            '<div class="scale-title"><i class="fas fa-mountain" style="color:#8b5cf6"></i> Pendiente del Terreno <span class="value-badge">' +
            slopeVal.toFixed(1) +
            "Â°</span></div>" +
            '<div class="scale-bar slope"></div>' +
            '<div class="scale-labels"><span>0Â° (Plano)</span><span>15Â° (Suave)</span><span>45Â°+ (Escarpado)</span></div>' +
            '<div class="interpretation-text">' +
            slopeInterp +
            "</div>" +
            "</div>";
        }

        // Generic interpretation if no specific scales
        if (html === "") {
          html =
            '<div class="scale-section">' +
            '<div class="scale-title"><i class="fas fa-chart-bar"></i> Resumen del Analisis</div>' +
            '<p style="color:var(--text-light)">Los resultados muestran los valores calculados para la ubicacion seleccionada. ' +
            "Valores positivos en indices de vegetacion indican mayor cobertura vegetal. " +
            "Pendientes bajas son mejores para construccion.</p>" +
            "</div>";
        }

        // Add satellite info
        html +=
          '<div style="margin-top:1rem; padding:1rem; background:#f0fdf4; border-radius:8px; font-size:0.85rem; color:var(--text-light);">' +
          '<i class="fas fa-satellite" style="color:var(--secondary)"></i> <strong>Fuente:</strong> Sentinel-2 MSI + SRTM | ' +
          '<i class="fas fa-calendar"></i> Imagen mas reciente disponible (ultimos 6 meses)' +
          "</div>";

        modalBody.innerHTML = html;
        document.getElementById("interpretation-modal").classList.add("active");

        // Store context for chat
        var locationName = selectedPlace
          ? selectedPlace.name
          : "ubicaciÃ³n seleccionada";
        analysisContext = {
          approach: approach,
          results: data,
          location: locationName,
        };

        // Fetch AI interpretation
        fetchAIInterpretation(data, approach, locationName);
      }

      function closeModal() {
        document
          .getElementById("interpretation-modal")
          .classList.remove("active");
      }

      // Close modal on outside click
      document
        .getElementById("interpretation-modal")
        .addEventListener("click", function (e) {
          if (e.target === this) closeModal();
        });

      // ============================================================================
      // CHAT AND AI FUNCTIONS
      // ============================================================================

      function toggleChat() {
        var sidebar = document.getElementById("chat-sidebar");
        sidebar.classList.toggle("open");
      }

      function sendChatMessage() {
        var input = document.getElementById("chat-input");
        var message = input.value.trim();
        if (!message) return;

        // Add user message to UI
        addChatMessage(message, "user");
        input.value = "";

        // Add to history
        chatHistory.push({ role: "user", content: message });

        // Show typing indicator
        var typingHtml =
          '<div class="chat-message assistant" id="typing-indicator">' +
          '<div class="message-bubble"><div class="typing-indicator"><span></span><span></span><span></span></div></div></div>';
        document
          .getElementById("chat-messages")
          .insertAdjacentHTML("beforeend", typingHtml);
        scrollChatToBottom();

        // Send to API
        fetch("/api/v1/chat", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            message: message,
            context: analysisContext,
            history: chatHistory,
          }),
        })
          .then((response) => response.json())
          .then((data) => {
            // Remove typing indicator
            var typing = document.getElementById("typing-indicator");
            if (typing) typing.remove();

            if (data.status === "success") {
              addChatMessage(data.response, "assistant");
              chatHistory.push({ role: "assistant", content: data.response });
            } else {
              addChatMessage(
                "Lo siento, hubo un error. Intenta de nuevo.",
                "assistant",
              );
            }
          })
          .catch((error) => {
            var typing = document.getElementById("typing-indicator");
            if (typing) typing.remove();
            addChatMessage(
              "Error de conexion. Verifica tu internet.",
              "assistant",
            );
          });
      }

      function addChatMessage(text, role) {
        var messagesContainer = document.getElementById("chat-messages");
        var time = new Date().toLocaleTimeString("es-CL", {
          hour: "2-digit",
          minute: "2-digit",
        });
        var html =
          '<div class="chat-message ' +
          role +
          '">' +
          '<div class="message-bubble">' +
          text.replace(/\\n/g, "<br>") +
          "</div>" +
          '<div class="message-time">' +
          time +
          "</div></div>";
        messagesContainer.insertAdjacentHTML("beforeend", html);
        scrollChatToBottom();
      }

      function scrollChatToBottom() {
        var container = document.getElementById("chat-messages");
        container.scrollTop = container.scrollHeight;
      }

      function requestAIInterpretation(
        results,
        approach,
        locationName,
        areaM2,
        meta,
      ) {
        // Show typing indicator in chat
        var typingHtml =
          '<div class="chat-message assistant" id="interpretation-typing">' +
          '<div class="message-bubble"><div class="typing-indicator"><span></span><span></span><span></span></div> Analizando datos...</div></div>';
        document
          .getElementById("chat-messages")
          .insertAdjacentHTML("beforeend", typingHtml);
        scrollChatToBottom();

        var areaKm2 = (areaM2 / 1000000).toFixed(2);
        var radiusM = meta ? meta.buffer_radius_m : 1000;

        // Add area info to results for context
        var enrichedResults = Object.assign({}, results);
        enrichedResults["Ãrea analizada"] =
          areaM2.toLocaleString() + " mÂ² (" + areaKm2 + " kmÂ²)";
        enrichedResults["Radio de anÃ¡lisis"] = radiusM + " metros";

        // Call interpret API (designed for analysis interpretation)
        fetch("/api/v1/interpret", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            results: enrichedResults,
            approach: approach,
            location: locationName,
          }),
        })
          .then((response) => response.json())
          .then((data) => {
            var typing = document.getElementById("interpretation-typing");
            if (typing) typing.remove();

            if (data.status === "success") {
              // Format and display interpretation
              var formattedResponse = data.interpretation
                .replace(/\\n/g, "<br>")
                .replace(/\\*\\*(.*?)\\*\\*/g, "<strong>$1</strong>")
                .replace(/\\*(.*?)\\*/g, "<em>$1</em>");

              var interpretationHtml =
                '<div class="chat-message assistant">' +
                '<div class="message-bubble" style="background: linear-gradient(135deg, #f0fdf4, #ecfeff); border-left: 3px solid var(--secondary);">' +
                '<div style="font-weight:600; color:var(--primary); margin-bottom:0.5rem;"><i class="fas fa-robot"></i> InterpretaciÃ³n del AnÃ¡lisis</div>' +
                '<div style="line-height:1.6;">' +
                formattedResponse +
                "</div>" +
                "</div>" +
                '<div class="message-time">' +
                new Date().toLocaleTimeString("es-CL", {
                  hour: "2-digit",
                  minute: "2-digit",
                }) +
                "</div>" +
                "</div>";

              document
                .getElementById("chat-messages")
                .insertAdjacentHTML("beforeend", interpretationHtml);
              scrollChatToBottom();

              // Add to history
              chatHistory.push({
                role: "user",
                content: "Interpreta los resultados del anÃ¡lisis",
              });
              chatHistory.push({
                role: "assistant",
                content: data.interpretation,
              });

              // Add follow-up suggestion
              var followUp =
                '<div class="chat-message assistant">' +
                '<div class="message-bubble" style="font-size:0.85rem;">' +
                "ðŸ’¡ Â¿Tienes alguna duda sobre estos resultados? Puedes preguntarme sobre los indices, valores o significados." +
                "</div></div>";
              document
                .getElementById("chat-messages")
                .insertAdjacentHTML("beforeend", followUp);
              scrollChatToBottom();
            } else {
              addChatMessage(
                "No pude generar la interpretaciÃ³n: " +
                  (data.message || "Error desconocido"),
                "assistant",
              );
            }
          })
          .catch((error) => {
            console.error("Interpretation error:", error);
            var typing = document.getElementById("interpretation-typing");
            if (typing) typing.remove();
            addChatMessage(
              "Error al conectar con el asistente. Verifica tu conexiÃ³n.",
              "assistant",
            );
          });
      }

      function fetchAIInterpretation(results, approach, locationName) {
        // Show loading in modal
        var modalBody = document.getElementById("modal-body");
        var existingContent = modalBody.innerHTML;

        var loadingHtml =
          '<div class="ai-loading" id="ai-loading">' +
          '<div class="typing-indicator"><span></span><span></span><span></span></div>' +
          "<span>Generando interpretacion con IA...</span></div>";
        modalBody.insertAdjacentHTML("beforeend", loadingHtml);

        fetch("/api/v1/interpret", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            results: results,
            approach: approach,
            location: locationName,
          }),
        })
          .then((response) => response.json())
          .then((data) => {
            var loading = document.getElementById("ai-loading");
            if (loading) loading.remove();

            if (data.status === "success") {
              // Format AI text with styled sections
              var formattedText = data.interpretation
                // Section headers with icons
                .replace(
                  /RESUMEN/g,
                  '<div class="ai-section"><h6 class="ai-section-title">ðŸ“‹ Resumen</h6><div class="ai-section-content">',
                )
                .replace(
                  /QUÃ‰ SIGNIFICAN LOS DATOS/g,
                  '</div></div><div class="ai-section"><h6 class="ai-section-title">ðŸ“Š QuÃ© Significan los Datos</h6><div class="ai-section-content">',
                )
                .replace(
                  /IMPLICACIONES PRÃCTICAS/g,
                  '</div></div><div class="ai-section"><h6 class="ai-section-title">ðŸ’¡ Implicaciones PrÃ¡cticas</h6><div class="ai-section-content">',
                )
                .replace(
                  /RECOMENDACIONES/g,
                  '</div></div><div class="ai-section"><h6 class="ai-section-title">âœ… Recomendaciones</h6><div class="ai-section-content">',
                )
                // Markdown bold - using string method
                .split("**")
                .map(function (part, i) {
                  return i % 2 === 1
                    ? '<strong style="color:var(--secondary)">' +
                        part +
                        "</strong>"
                    : part;
                })
                .join("")
                // Line breaks
                .split(String.fromCharCode(10))
                .join("<br>");

              // Close any open section
              if (formattedText.includes("ai-section-content")) {
                formattedText += "</div></div>";
              }
              // Clean up empty opening tag if first section not matched
              formattedText = formattedText.replace(/^<\/div><\/div>/, "");

              var aiHtml =
                '<div class="ai-interpretation" style="margin-top:1.5rem; padding:1rem; background:linear-gradient(135deg, #f0fdf4 0%, #ecfeff 100%); border-radius:12px; border-left:4px solid var(--secondary);">' +
                '<h5 style="margin:0 0 1rem; color:var(--primary); display:flex; align-items:center; gap:0.5rem;"><i class="fas fa-robot"></i> InterpretaciÃ³n del Asistente IA</h5>' +
                '<div class="ai-content" style="line-height:1.7; color:var(--text);">' +
                formattedText +
                "</div>" +
                "</div>";

              // Add section styles dynamically
              if (!document.getElementById("ai-section-styles")) {
                var styles = document.createElement("style");
                styles.id = "ai-section-styles";
                styles.textContent =
                  ".ai-section { margin-bottom:1rem; } .ai-section-title { color:var(--primary); margin:0 0 0.5rem; padding-bottom:0.3rem; border-bottom:1px solid rgba(45,90,74,0.2); font-size:0.9rem; font-weight:600; } .ai-section-content { padding-left:0.5rem; }";
                document.head.appendChild(styles);
              }

              modalBody.insertAdjacentHTML("beforeend", aiHtml);
            } else {
              var errorHtml =
                '<div class="ai-interpretation" style="margin-top:1rem; padding:1rem; background:#fef2f2; border-radius:8px; color:#dc2626;">' +
                '<i class="fas fa-exclamation-circle"></i> No se pudo generar la interpretaciÃ³n. Intenta de nuevo.' +
                "</div>";
              modalBody.insertAdjacentHTML("beforeend", errorHtml);
            }
          })
          .catch((error) => {
            var loading = document.getElementById("ai-loading");
            if (loading) loading.remove();
            console.error("AI Interpretation error:", error);
          });
      }

      // Contact Form Handler
      document
        .getElementById("contact-form")
        .addEventListener("submit", function (e) {
          e.preventDefault();
          var btn = document.getElementById("contact-submit");
          var originalText = btn.innerHTML;
          btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Enviando...';
          btn.disabled = true;

          var formData = {
            name: document.getElementById("contact-name").value,
            company: document.getElementById("contact-company").value,
            email: document.getElementById("contact-email").value,
            message: document.getElementById("contact-message").value,
          };

          fetch("/api/v1/contact", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(formData),
          })
            .then((response) => response.json())
            .then((data) => {
              btn.innerHTML = originalText;
              btn.disabled = false;
              if (data.status === "success") {
                document.getElementById("contact-success").style.display =
                  "block";
                document.getElementById("contact-form").reset();
                // El mensaje de Ã©xito permanece visible
              } else {
                alert(
                  "Error al enviar: " + (data.message || "Intenta nuevamente"),
                );
              }
            })
            .catch((error) => {
              btn.innerHTML = originalText;
              btn.disabled = false;
              alert("Error de conexion. Intenta nuevamente.");
            });
        });

      // ============================================================================
      // MOBILE TAB NAVIGATION
      // ============================================================================

      function isMobileView() {
        return window.innerWidth <= 768;
      }

      function switchTab(tabName) {
        // Update active tab button
        document.querySelectorAll(".mobile-tab").forEach(function (tab) {
          tab.classList.remove("active");
          if (tab.dataset.tab === tabName) {
            tab.classList.add("active");
          }
        });

        // Scroll to the corresponding section
        var sectionMap = {
          inicio: "hero",
          demo: "demo",
          servicios: "servicios",
          contacto: "contacto",
        };

        var targetId = sectionMap[tabName];
        var section = null;

        if (targetId === "hero") {
          section = document.querySelector(".hero");
        } else {
          section = document.getElementById(targetId);
        }

        if (section) {
          var offset = isMobileView() ? 60 : 0; // Account for mobile header
          var sectionTop =
            section.getBoundingClientRect().top + window.pageYOffset - offset;
          window.scrollTo({ top: sectionTop, behavior: "smooth" });
        }
      }

      // Update active tab on scroll
      function updateActiveTabOnScroll() {
        if (!isMobileView()) return;

        var sections = [
          {
            id: "hero",
            tab: "inicio",
            element: document.querySelector(".hero"),
          },
          { id: "demo", tab: "demo", element: document.getElementById("demo") },
          {
            id: "servicios",
            tab: "servicios",
            element: document.getElementById("servicios"),
          },
          {
            id: "contacto",
            tab: "contacto",
            element: document.getElementById("contacto"),
          },
        ];

        var scrollPos = window.scrollY + 150;

        for (var i = sections.length - 1; i >= 0; i--) {
          var section = sections[i];
          if (section.element && section.element.offsetTop <= scrollPos) {
            document.querySelectorAll(".mobile-tab").forEach(function (tab) {
              tab.classList.remove("active");
              if (tab.dataset.tab === section.tab) {
                tab.classList.add("active");
              }
            });
            break;
          }
        }
      }

      // Enable mobile mode on mobile devices
      function initMobileMode() {
        if (isMobileView()) {
          document.body.classList.add("mobile-tab-mode");
        } else {
          document.body.classList.remove("mobile-tab-mode");
        }
      }

      // Initialize mobile mode and add scroll listener
      window.addEventListener("resize", initMobileMode);
      window.addEventListener("scroll", updateActiveTabOnScroll);
      document.addEventListener("DOMContentLoaded", function () {
        initMobileMode();
        updateActiveTabOnScroll();
        fetchPublicStats(); // [NEW] Fetch stats on load
      });

      // [NEW] Fetch Public Stats
      function fetchPublicStats() {
          fetch('/api/v1/stats')
            .then(response => response.json())
            .then(data => {
                if(data.visits !== undefined) {
                    animateValue("stat-visits", 0, data.visits, 2000);
                    animateValue("stat-analyses", 0, data.analyses, 2000);
                }
            })
            .catch(err => console.error("Error fetching stats:", err));
      }

      function animateValue(id, start, end, duration) {
          if (start === end) return;
          var range = end - start;
          var current = start;
          var increment = end > start ? 1 : -1;
          var stepTime = Math.abs(Math.floor(duration / range));
          var obj = document.getElementById(id);
          var timer = setInterval(function() {
              current += increment;
              obj.innerHTML = current.toLocaleString();
              if (current == end) {
                  clearInterval(timer);
              }
          }, stepTime);
      }


      // ============================================================================
      // LANGUAGE TOGGLE LOGIC
      // ============================================================================
      let currentLang = 'es';

      function toggleLanguage() {
        currentLang = currentLang === 'es' ? 'en' : 'es';
        updateLanguage();
      }

      function updateLanguage() {
        const isEn = currentLang === 'en';
        
        // Update Button
        const langIcon = document.getElementById('lang-icon');
        const langText = document.getElementById('lang-text');
        if(langIcon) langIcon.textContent = isEn ? 'ðŸ‡¨ðŸ‡±' : 'ðŸ‡ºðŸ‡¸';
        if(langText) langText.textContent = isEn ? 'ES' : 'EN';
        
        // Translate Elements with data-en
        const elements = document.querySelectorAll('[data-en]');
        elements.forEach(el => {
            if (!el.dataset.original) el.dataset.original = el.textContent; // Cache original ES
            el.textContent = isEn ? el.dataset.en : el.dataset.original;
        });

        // Translate Elements with data-en-html (preserve HTML inside)
         const htmlElements = document.querySelectorAll('[data-en-html]');
         htmlElements.forEach(el => {
            if (!el.dataset.originalHtml) el.dataset.originalHtml = el.innerHTML; // Cache original ES HTML
            el.innerHTML = isEn ? el.dataset.enHtml : el.dataset.originalHtml;
        });

        // Translate Placeholders
        const inputElements = document.querySelectorAll('[data-en-placeholder]');
        inputElements.forEach(el => {
            if (!el.dataset.originalPlaceholder) el.dataset.originalPlaceholder = el.placeholder;
            el.placeholder = isEn ? el.dataset.enPlaceholder : el.dataset.originalPlaceholder;
        });

        // Translate Titles (Tooltip)
        const titleElements = document.querySelectorAll('[data-en-title]');
        titleElements.forEach(el => {
            if (!el.dataset.originalTitle) el.dataset.originalTitle = el.title;
            el.title = isEn ? el.dataset.enTitle : el.dataset.originalTitle;
        });
      }

      // Start the map initialization
      loadGoogleMaps();
    </script>
  </body>
</html>
